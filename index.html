<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZ FOR CSS ASPIRANTS - 21 APRIL 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Disable text selection */
        body {
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* IE 10 and IE 11 */
            user-select: none; /* Standard syntax */
            font-family: 'Inter', sans-serif; /* Use Inter font */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Ensure radio buttons and labels are aligned */
        .quiz-option label {
            display: inline-block;
            vertical-align: middle;
            margin-left: 8px; /* Space between radio and text */
        }
        .quiz-option input[type="radio"] {
            vertical-align: middle;
        }
         /* Add some subtle animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
         /* Style for sentence rearrangement options */
        .rearrangement-option {
            cursor: pointer;
            border: 1px solid #ccc;
            padding: 8px;
            margin: 4px 0;
            border-radius: 6px;
            background-color: #f9f9f9;
            transition: background-color 0.2s;
        }
        .rearrangement-option:hover {
            background-color: #e0e0e0;
        }
        .selected-rearrangement {
            background-color: #d1e7fd;
            border-color: #0d6efd;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-gray-100 to-gray-300 min-h-screen flex flex-col" oncontextmenu="return false;">

    <header class="bg-gradient-to-r from-slate-800 to-slate-900 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
             <div class="flex items-center space-x-3">
                 <img
                    src="https://media-hosting.imagekit.io//0b9a4af30efb4482/WhatsApp%20Image%202025-02-28%20at%203.15.19%20AM.jpeg?Expires=1835349432&Key-Pair-Id=K2ZIVPTIP2VGHC&Signature=jwJPYv24ynvpiPUADnh2kUGPUbG6OBggLpvXOj6~ZZAgts7lamWPTIZKmuIaQ5WaRUAG568acIjSbBE1XrKsIPvCHTXKNA-XF6ppaM~tacD0TMTVoTFd7-EsYFsesMaR~5AK7n5qr33hIwKVawluJ1rkdqmuQokM~T~W~O~6Yo-qXgYGio2IvfBsu1u~wEi1Cnk-5pAOavMUb9IfeY7E4FNwGBgiLCiHugKJD9sAY8As7S0szpehWI8WIQzMzNUFN4wvtPAamSART1m5nlUT4uLcvwdr-C1pk4kJN6I0itWzZEbZN04ANZexY3dpBhUDO0~UvQBCps64LPKIQBRYtA__"
                    alt="User Logo"
                    class="h-12 w-12 rounded-full border-2 border-blue-300 object-cover"
                    onerror="this.onerror=null; this.src='https://placehold.co/60x60/e2e8f0/64748b?text=Logo';"
                 >
                 <div>
                    <h1 class="text-xl md:text-2xl font-bold tracking-tight">QUIZ FOR CSS ASPIRANTS</h1>
                    <p class="text-sm text-blue-300">SYED ASGHAR ALI SHAH - April 21, 2025</p>
                 </div>
             </div>
             <div id="timer-display" class="text-lg font-semibold bg-red-600 px-3 py-1 rounded-md shadow-md hidden">
                Time Left: <span id="time">25:00</span>
             </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 flex-grow">

        <section id="name-section" class="bg-white p-6 md:p-8 rounded-lg shadow-xl max-w-lg mx-auto fade-in">
            <h2 class="text-2xl font-semibold mb-6 text-center text-gray-700">Welcome to the Quiz</h2>
            <p class="text-gray-600 mb-6 text-center">Please enter your full name to begin.</p>
            <div class="mb-4">
                <label for="student-name" class="block text-sm font-medium text-gray-700 mb-1">Full Name:</label>
                <input type="text" id="student-name" name="student-name" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out" placeholder="e.g., Affan Qayum" autocomplete="off">
                <p id="name-error" class="text-red-500 text-sm mt-1 hidden">Please enter your name.</p>
            </div>
            <button id="start-quiz-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                Start Quiz
            </button>
        </section>

        <section id="quiz-section" class="hidden bg-white p-6 md:p-8 rounded-lg shadow-xl fade-in">
            <h2 class="text-2xl font-semibold mb-6 text-center text-gray-800">English Grammar & Vocabulary Quiz</h2>
            <form id="quiz-form">
                <div id="questions-container" class="space-y-8"></div>

                <button type="submit" id="submit-quiz-btn" class="mt-8 w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-md transition duration-150 ease-in-out shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                    Submit Quiz
                </button>
            </form>
        </section>

        <section id="results-section" class="hidden bg-white p-6 md:p-8 rounded-lg shadow-xl max-w-lg mx-auto text-center fade-in">
            <h2 class="text-2xl font-bold mb-4 text-gray-800">Quiz Results</h2>
            <div class="space-y-3 text-left border border-gray-200 p-4 rounded-md bg-gray-50">
                <p class="text-lg"><strong class="font-semibold text-gray-700">Name:</strong> <span id="result-name" class="text-blue-600"></span></p>
                <p class="text-lg"><strong class="font-semibold text-gray-700">Questions Attempted:</strong> <span id="result-attempted" class="text-blue-600"></span> / 50</p>
                <p class="text-lg"><strong class="font-semibold text-gray-700">Correct Answers:</strong> <span id="result-score" class="text-green-600 font-bold"></span> / 50</p>
                <p class="text-lg"><strong class="font-semibold text-gray-700">Time Taken:</strong> <span id="result-time" class="text-blue-600"></span></p>
                <p class="text-lg"><strong class="font-semibold text-gray-700">Percentage:</strong> <span id="result-percentage" class="text-green-600 font-bold"></span>%</p>
            </div>
             <p class="mt-6 text-gray-600">Your results have been recorded. Thank you for participating!</p>
        </section>

        <form id="hidden-form" action="https://formspree.io/f/xwpvddea" method="POST" class="hidden">
            <input type="text" name="name" id="form-name">
            <input type="text" name="attempted" id="form-attempted">
            <input type="text" name="score" id="form-score">
            <input type="text" name="time_taken" id="form-time">
            <input type="text" name="percentage" id="form-percentage">
        </form>

    </main>

    <footer class="bg-gradient-to-r from-slate-800 to-slate-900 text-white py-4 mt-12 shadow-inner">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm">Need Assistance? Contact us at: <strong class="text-blue-300">03265762698</strong></p>
            <p class="text-xs mt-1 text-gray-400">&copy; 2025 SYED ASGHAR ALI SHAH - CSS Aspirant Resources. All rights reserved.</p>
             <p class="text-sm mt-2">Ready to test your knowledge?</p>
        </div>
    </footer>

    <script>
        // --- Quiz Data ---
        // Questions derived from the provided PDFs (IDIOMS Notes and Grammar Analysis)
        // Focus on Grammar, Parts of Speech, Prepositions, Idioms, Synonyms, Antonyms, Sentence Rearrangement
        const quizData = [
            // Grammar: Parts of Speech & Sentence Structure
            {
                question: "Identify the part of speech for the word 'fundamental' in the sentence: 'There are fundamental problems with the system.'",
                options: ["Noun", "Adjective", "Adverb", "Verb"],
                answer: "Adjective",
                type: "mcq"
            },
            {
                question: "Which sentence structure best describes: 'Pakistan's problems seem to multiply by the day and contribute to the country's deepening polarisation and instability.'?",
                options: ["Simple", "Compound", "Complex", "Compound-Complex"],
                answer: "Compound-Complex",
                type: "mcq"
            },
            {
                question: "In 'Appreciation is earned by performance', what is the voice of the verb 'is earned'?",
                options: ["Active Voice", "Passive Voice", "Middle Voice", "Reflexive Voice"],
                answer: "Passive Voice",
                type: "mcq"
            },
            {
                question: "What type of noun is 'governance'?",
                options: ["Proper Noun", "Concrete Noun", "Abstract Noun", "Collective Noun"],
                answer: "Abstract Noun",
                type: "mcq"
            },
             {
                question: "Identify the function of 'to tackle' in the phrase 'a serious effort to tackle structural problems'.",
                options: ["Gerund (acting as noun)", "Infinitive (acting as adjective)", "Participle (acting as adjective)", "Infinitive (acting as adverb)", "Infinitive (acting as noun)"],
                answer: "Infinitive (acting as adjective)", // Modifies 'effort'
                type: "mcq"
            },
             {
                question: "Which word acts as a coordinating conjunction in the sentence: 'Leadership means setting a clear direction...and forging national consensus...'?",
                options: ["means", "setting", "and", "forging", "clear"],
                answer: "and",
                type: "mcq"
            },
             {
                question: "What is the grammatical function of 'multiplying' in 'Pakistan's problems seem to multiply...'?",
                options: ["Present Participle", "Gerund", "Main Verb (Infinitive form)", "Adjective"],
                answer: "Main Verb (Infinitive form)", // Part of the infinitive 'to multiply' after 'seem'
                type: "mcq"
            },
            {
                question: "Identify the prepositional phrase indicating location in 'Billboards across Punjab...'?",
                options: ["Billboards across", "across Punjab", "Billboards", "Punjab"],
                answer: "across Punjab",
                type: "mcq"
            },
             {
                question: "What type of clause is 'when they transcend the circumstances they inherit'?",
                options: ["Independent Clause", "Noun Clause", "Adjectival Clause", "Adverbial Clause"],
                answer: "Adverbial Clause", // Modifies the main clause, indicating time
                type: "mcq"
            },
            {
                question: "Which word is the adverb modifying 'short' in 'governance remains way short of public expectations'?",
                options: ["remains", "public", "expectations", "way"],
                answer: "way", // Adverb of degree
                type: "mcq"
            },

            // Idioms
            {
                question: "What is the meaning of the idiom 'No stone unturned'?",
                options: ["To give up easily", "To make every possible effort", "To look only in obvious places", "To be lazy in searching"],
                answer: "To make every possible effort",
                type: "mcq"
            },
            {
                question: "The idiom 'Law of the jungle' refers to a situation where:",
                options: ["Legal principles are strictly followed", "Animals dictate the rules", "People act without regard for law or rights", "Judges preside over nature"],
                answer: "People act without regard for law or rights",
                type: "mcq"
            },
            {
                question: "What does 'Turn a new page' mean?",
                options: ["To read a different book", "To continue in the same old way", "To start a new and better chapter", "To tear a page out"],
                answer: "To start a new and better chapter",
                type: "mcq"
            },
            {
                question: "If news is 'splashed all over' the front page, it means the news is:",
                options: ["Hidden in a small corner", "Displayed very prominently", "Written unclearly", "Only mentioned briefly"],
                answer: "Displayed very prominently",
                type: "mcq"
            },
             {
                question: "The phrase 'add up to' in 'His arguments don't add up to a convincing case' means:",
                options: ["Subtract from", "Mathematically calculate", "Amount to or result in", "Contradict"],
                answer: "Amount to or result in",
                type: "mcq"
            },

            // Synonyms
            {
                question: "Which word is a synonym for 'Rigorous'?",
                options: ["Lax", "Careless", "Superficial", "Thorough", "Gentle"],
                answer: "Thorough",
                type: "mcq"
            },
            {
                question: "A synonym for 'Fragile' is:",
                options: ["Robust", "Strong", "Durable", "Delicate"],
                answer: "Delicate",
                type: "mcq"
            },
            {
                question: "Choose the best synonym for 'Capability'.",
                options: ["Weakness", "Inability", "Incompetence", "Ability"],
                answer: "Ability",
                type: "mcq"
            },
            {
                question: "What is a synonym for 'Elicit'?",
                options: ["Suppress", "Hide", "Conceal", "Obtain", "Ignore"],
                answer: "Obtain",
                type: "mcq"
            },
             {
                question: "Find the synonym for 'Seminal'.",
                options: ["Unimportant", "Influential", "Minor", "Insignificant", "Trivial"],
                answer: "Influential",
                type: "mcq"
            },
             {
                question: "Which word is closest in meaning to 'Oversight' when it means supervision?",
                options: ["Neglect", "Inattention", "Management", "Mistake"],
                answer: "Management", // Oversight has dual meanings, this focuses on the supervision aspect mentioned.
                type: "mcq"
            },
             {
                question: "A synonym for 'Sustainable' is:",
                options: ["Temporary", "Viable", "Fleeting", "Unsustainable"],
                answer: "Viable",
                type: "mcq"
            },
             {
                question: "What is a synonym for 'Commitment'?",
                options: ["Indifference", "Apathy", "Dedication", "Hesitation"],
                answer: "Dedication",
                type: "mcq"
            },
             {
                question: "Choose the synonym for 'Affirmation'.",
                options: ["Denial", "Rejection", "Negation", "Endorsement"],
                answer: "Endorsement",
                type: "mcq"
            },
             {
                question: "Which word means the same as 'Ascended'?",
                options: ["Descended", "Fell", "Declined", "Rose"],
                answer: "Rose",
                type: "mcq"
            },

            // Antonyms
            {
                question: "What is the antonym of 'Polarisation'?",
                options: ["Division", "Separation", "Conflict", "Unity", "Disagreement"],
                answer: "Unity",
                type: "mcq"
            },
            {
                question: "The antonym for 'Premature' is:",
                options: ["Early", "Untimely", "Hasty", "Timely"],
                answer: "Timely",
                type: "mcq"
            },
            {
                question: "Find the antonym of 'Empowered'.",
                options: ["Authorized", "Enabled", "Permitted", "Disempowered"],
                answer: "Disempowered",
                type: "mcq"
            },
            {
                question: "What is the opposite of 'Hesitant'?",
                options: ["Reluctant", "Uncertain", "Unwilling", "Eager"],
                answer: "Eager",
                type: "mcq"
            },
             {
                question: "Choose the antonym for 'Friction'.",
                options: ["Conflict", "Tension", "Disagreement", "Harmony"],
                answer: "Harmony",
                type: "mcq"
            },
             {
                question: "What is the opposite of 'Inflated'?",
                options: ["Exaggerated", "Increased", "Augmented", "Understated"],
                answer: "Understated",
                type: "mcq"
            },
             {
                question: "Find the antonym for 'Unabated'.",
                options: ["Relentless", "Persistent", "Constant", "Decreased"],
                answer: "Decreased",
                type: "mcq"
            },
             {
                question: "The antonym of 'Fundamental' is:",
                options: ["Basic", "Essential", "Primary", "Inessential"],
                answer: "Inessential",
                type: "mcq"
            },
             {
                question: "What is the opposite of 'Convening'?",
                options: ["Assembling", "Gathering", "Meeting", "Dispersing"],
                answer: "Dispersing",
                type: "mcq"
            },
             {
                question: "Choose the antonym for 'Revive'.",
                options: ["Restore", "Resuscitate", "Rejuvenate", "Kill"],
                answer: "Kill",
                type: "mcq"
            },

             // Prepositions
            {
                question: "Choose the correct preposition: 'The two companies are ___ a legal dispute.'",
                options: ["on", "at", "in", "over"],
                answer: "in",
                type: "mcq"
            },
            {
                question: "Fill in the blank: 'He showed great spirit ___ the face of adversity.'",
                options: ["on", "in", "at", "with"],
                answer: "in",
                type: "mcq"
            },
            {
                question: "Select the appropriate preposition: 'Measures were taken ___ the stabilisation of the currency.'",
                options: ["to", "for", "with", "about"],
                answer: "for",
                type: "mcq"
            },
            {
                question: "Complete the sentence: 'There is friction ___ the two departments.'",
                options: ["among", "between", "within", "across"],
                answer: "between",
                type: "mcq"
            },
             {
                question: "Choose the correct preposition: 'The country maintained a policy ___ non-alignment.'",
                options: ["of", "for", "about", "with"],
                answer: "of",
                type: "mcq"
            },

             // Sentence Rearrangement
            {
                question: "Rearrange the following parts to form a meaningful sentence: (A) seem to multiply / (B) and instability / (C) Pakistan's problems / (D) by the day and contribute to the country's deepening polarisation",
                options: ["CADB", "ACDB", "CABD", "CDAB"],
                answer: "CADB", // Pakistan's problems seem to multiply by the day and contribute to the country's deepening polarisation and instability.
                type: "rearrangement",
                 parts: {
                    A: "seem to multiply",
                    B: "and instability",
                    C: "Pakistan's problems",
                    D: "by the day and contribute to the country's deepening polarisation"
                }
            },
            {
                question: "Arrange the segments into a coherent sentence: (P) has not produced governance / (Q) and the gap between challenge / (R) That is why rule / (S) and response has grown larger",
                options: ["RQPS", "RPSQ", "SPRQ", "QPSR"],
                answer: "RPSQ", // That is why rule has not produced governance and the gap between challenge and response has grown larger.
                type: "rearrangement",
                 parts: {
                    P: "has not produced governance",
                    Q: "and the gap between challenge",
                    R: "That is why rule",
                    S: "and response has grown larger"
                }
            },
             {
                question: "Form a logical sentence: (1) leadership matters / (2) even more because / (3) of the enormity and complexity / (4) today / (5) of the problems",
                options: ["41235", "12345", "41325", "14235"],
                answer: "41235", // today leadership matters even more because of the enormity and complexity of the problems
                type: "rearrangement",
                parts: {
                    1: "leadership matters",
                    2: "even more because",
                    3: "of the enormity and complexity",
                    4: "today",
                    5: "of the problems"
                }
            },
            {
                question: "Rearrange to make a correct sentence: (X) the bold reforms needed / (Y) shying away from / (Z) to unlock the country's potential / (W) involves prioritising short-term fixes over",
                options: ["WYZX", "WXYZ", "YWZX", "WYXZ"],
                answer: "WYXZ", // involves prioritising short-term fixes over shying away from the bold reforms needed to unlock the country's potential
                type: "rearrangement",
                parts: {
                    W: "involves prioritising short-term fixes over",
                    X: "the bold reforms needed",
                    Y: "shying away from",
                    Z: "to unlock the country's potential"
                }
            },

            // Mixed Tough Questions
            {
                question: "Which phrase implies a lack of genuine substance or expertise, often used skeptically?",
                options: ["Textbook case", "Rule of law", "So-called", "Landmark decision"],
                answer: "So-called",
                type: "mcq"
            },
            {
                question: "The term 'Endemic', when referring to a disease, means it is:",
                options: ["Universally present", "Recently introduced", "Regularly found in a specific area or population", "Completely eradicated"],
                answer: "Regularly found in a specific area or population",
                type: "mcq"
            },
             {
                question: "Identify the most accurate description of 'Self-congratulatory'.",
                options: ["Humble and modest", "Expressing excessive satisfaction with oneself", "Critical of others' achievements", "Seeking validation from others"],
                answer: "Expressing excessive satisfaction with oneself",
                type: "mcq"
            },
             {
                question: "What concept is contrasted with 'Rule of law' in the provided texts?",
                options: ["Freedom of navigation", "Law of the jungle", "Bloodbath", "Textbook case"],
                answer: "Law of the jungle",
                type: "mcq"
            },
            {
                question: "Which term describes a split or division between strongly opposed groups due to differences in belief?",
                options: ["Polarisation", "Schism", "Friction", "Dispute"],
                answer: "Schism",
                type: "mcq"
            },
             {
                question: "What does 'Wielding power' specifically refer to in the context of leadership?",
                options: ["Holding and using authority or influence", "Sharing power equally", "Abdicating responsibility", "Following orders"],
                answer: "Holding and using authority or influence",
                type: "mcq"
            }


        ];

        // --- DOM Elements ---
        const nameSection = document.getElementById('name-section');
        const quizSection = document.getElementById('quiz-section');
        const resultsSection = document.getElementById('results-section');
        const nameInput = document.getElementById('student-name');
        const nameError = document.getElementById('name-error');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const quizForm = document.getElementById('quiz-form');
        const questionsContainer = document.getElementById('questions-container');
        const timerDisplay = document.getElementById('timer-display');
        const timeEl = document.getElementById('time');
        const resultName = document.getElementById('result-name');
        const resultAttempted = document.getElementById('result-attempted');
        const resultScore = document.getElementById('result-score');
        const resultTime = document.getElementById('result-time');
        const resultPercentage = document.getElementById('result-percentage');
        const hiddenForm = document.getElementById('hidden-form');
        const formName = document.getElementById('form-name');
        const formAttempted = document.getElementById('form-attempted');
        const formScore = document.getElementById('form-score');
        const formTime = document.getElementById('form-time');
        const formPercentage = document.getElementById('form-percentage');

        // --- Quiz State ---
        let currentQuestionIndex = 0; // Not used for displaying all at once, but useful conceptually
        let timerInterval;
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let timeTaken = 0;
        let studentName = '';
        let quizSubmitted = false; // Flag to prevent double submission

        // --- Functions ---

        // Shuffle array elements (Fisher-Yates algorithm)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Function to create and display questions
        function displayQuestions() {
            questionsContainer.innerHTML = ''; // Clear previous questions
             // Shuffle the quiz data itself to randomize question order
            shuffleArray(quizData);

            quizData.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('question-block', 'border', 'border-gray-200', 'p-4', 'rounded-md', 'bg-gray-50');
                questionDiv.setAttribute('data-question-index', index); // Store original index if needed

                const questionText = document.createElement('p');
                questionText.classList.add('text-lg', 'font-medium', 'mb-4', 'text-gray-800');
                questionText.innerHTML = `<strong>Q ${index + 1}:</strong> ${q.question}`; // Use innerHTML for bold tag
                questionDiv.appendChild(questionText);

                const optionsDiv = document.createElement('div');
                optionsDiv.classList.add('options', 'space-y-2');

                // Shuffle options for MCQ questions
                let options = [...q.options]; // Create a copy
                if (q.type === 'mcq') {
                    shuffleArray(options); // Shuffle the copied options
                }

                if (q.type === 'mcq') {
                     options.forEach(option => {
                        const optionLabel = document.createElement('label');
                        optionLabel.classList.add('block', 'quiz-option', 'p-2', 'border', 'border-gray-300', 'rounded-md', 'hover:bg-gray-100', 'cursor-pointer', 'transition', 'duration-150');

                        const radioInput = document.createElement('input');
                        radioInput.type = 'radio';
                        radioInput.name = `question-${index}`;
                        radioInput.value = option;
                        radioInput.classList.add('mr-2', 'accent-blue-600');

                        optionLabel.appendChild(radioInput);
                        optionLabel.appendChild(document.createTextNode(option)); // Use createTextNode for safety
                        optionsDiv.appendChild(optionLabel);
                    });
                } else if (q.type === 'rearrangement') {
                     const partsContainer = document.createElement('div');
                     partsContainer.classList.add('mb-2', 'text-sm', 'text-gray-600');
                     partsContainer.innerHTML = '<strong>Parts:</strong> ' + Object.entries(q.parts).map(([key, value]) => `${key}: ${value}`).join('; ');
                     questionDiv.appendChild(partsContainer);

                     options.forEach(option => {
                        const optionLabel = document.createElement('label');
                        optionLabel.classList.add('block', 'quiz-option', 'p-2', 'border', 'border-gray-300', 'rounded-md', 'hover:bg-gray-100', 'cursor-pointer', 'transition', 'duration-150');

                        const radioInput = document.createElement('input');
                        radioInput.type = 'radio';
                        radioInput.name = `question-${index}`;
                        radioInput.value = option;
                        radioInput.classList.add('mr-2', 'accent-blue-600');

                        optionLabel.appendChild(radioInput);
                        // Display the sequence corresponding to the option letters
                        const sequenceText = option.split('').map(letter => q.parts[letter] || `Part ${letter}`).join(' / ');
                        optionLabel.appendChild(document.createTextNode(`${option}: ${sequenceText}`));
                        optionsDiv.appendChild(optionLabel);
                    });
                }


                questionDiv.appendChild(optionsDiv);
                questionsContainer.appendChild(questionDiv);
            });
        }

        // Function to start the timer
        function startTimer() {
            timerDisplay.classList.remove('hidden');
            timerInterval = setInterval(() => {
                timeLeft--;
                timeTaken++;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timeEl.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timeEl.textContent = "0:00";
                    submitQuiz(true); // Auto-submit
                }
                 // Visual cue when time is low
                if (timeLeft <= 60) { // Last minute
                    timerDisplay.classList.remove('bg-red-600');
                    timerDisplay.classList.add('bg-yellow-500', 'text-black', 'animate-pulse');
                }

            }, 1000);
        }

        // Function to calculate results
        function calculateResults() {
            let score = 0;
            let attempted = 0;
            const formData = new FormData(quizForm);

             quizData.forEach((q, index) => {
                const userAnswer = formData.get(`question-${index}`);
                if (userAnswer !== null) { // Check if the question was answered
                    attempted++;
                    if (userAnswer === q.answer) {
                        score++;
                    }
                }
            });


            return { score, attempted };
        }

        // Function to format time taken
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes} minute${minutes !== 1 ? 's' : ''}, ${seconds} second${seconds !== 1 ? 's' : ''}`;
        }


        // Function to handle quiz submission
        function submitQuiz(isAutoSubmit = false) {
            if (quizSubmitted) return; // Prevent multiple submissions
            quizSubmitted = true;

            clearInterval(timerInterval); // Stop the timer

            const results = calculateResults();
            const finalTimeTaken = formatTime(timeTaken);
            const percentage = ((results.score / quizData.length) * 100).toFixed(1);

            // Display results
            resultName.textContent = studentName;
            resultAttempted.textContent = results.attempted;
            resultScore.textContent = results.score;
            resultTime.textContent = finalTimeTaken;
            resultPercentage.textContent = percentage;


            quizSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            timerDisplay.classList.add('hidden'); // Hide timer on results page

            // Populate and submit hidden form
            formName.value = studentName;
            formAttempted.value = results.attempted;
            formScore.value = results.score;
            formTime.value = finalTimeTaken;
            formPercentage.value = percentage;


            // Optional: Add a small delay before submitting Formspree
             setTimeout(() => {
                hiddenForm.submit();
            }, 500); // 0.5 second delay


            if (isAutoSubmit) {
                 // Optionally show a message indicating auto-submission
                 const autoSubmitMsg = document.createElement('p');
                 autoSubmitMsg.textContent = "Time ran out! Your quiz was submitted automatically.";
                 autoSubmitMsg.classList.add('text-red-600', 'font-semibold', 'mt-4');
                 resultsSection.insertBefore(autoSubmitMsg, resultsSection.firstChild.nextSibling); // Insert after the heading
            }
        }

        // --- Event Listeners ---

        // Start Quiz Button
        startQuizBtn.addEventListener('click', () => {
            studentName = nameInput.value.trim();
            if (studentName === '') {
                nameError.classList.remove('hidden');
                nameInput.classList.add('border-red-500');
            } else {
                nameError.classList.add('hidden');
                nameInput.classList.remove('border-red-500');
                nameSection.classList.add('hidden');
                quizSection.classList.remove('hidden');
                displayQuestions();
                startTimer();
            }
        });

         // Allow starting quiz by pressing Enter in the name field
         nameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                 startQuizBtn.click(); // Trigger the button click
            }
        });


        // Quiz Form Submission
        quizForm.addEventListener('submit', (e) => {
            e.preventDefault(); // Prevent default form submission
            submitQuiz();
        });

         // Add listener to radio buttons to visually indicate selection
         questionsContainer.addEventListener('change', (event) => {
            if (event.target.type === 'radio') {
                const questionBlock = event.target.closest('.question-block');
                // Remove highlight from previously selected option in the same question
                questionBlock.querySelectorAll('.quiz-option').forEach(label => {
                    label.classList.remove('bg-blue-100', 'border-blue-400');
                });
                // Add highlight to the currently selected option's label
                const selectedLabel = event.target.closest('.quiz-option');
                if (selectedLabel) {
                    selectedLabel.classList.add('bg-blue-100', 'border-blue-400');
                }
            }
        });


    </script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZ FOR CSS ASPIRANTS 02 MAY 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply Inter font globally */
        body {
            font-family: 'Inter', sans-serif;
            /* Disable text selection */
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* IE 10 and IE 11 */
            user-select: none; /* Standard syntax */
            /* Prevent image dragging */
            -webkit-user-drag: none;
            user-drag: none;
        }
        /* Custom scrollbar for better aesthetics (optional) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Style for quiz options */
        .option-label {
            display: block;
            padding: 12px 15px;
            margin-bottom: 10px;
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
        }
        .option-label:hover {
            background-color: #f3f4f6; /* gray-100 */
        }
        .option-label input[type="radio"] {
            display: none; /* Hide the actual radio button */
        }
        .option-label input[type="radio"]:checked + span {
             font-weight: 600; /* Make selected option bold */
        }
         /* Style for selected option */
        .option-label.selected {
            background-color: #dbeafe; /* blue-100 */
            border-color: #60a5fa; /* blue-400 */
        }
        /* Style for sentence rearrangement parts */
        .sentence-part {
            display: inline-block;
            padding: 5px 10px;
            margin: 5px;
            background-color: #e5e7eb; /* gray-200 */
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 6px;
            cursor: grab;
            transition: background-color 0.2s;
        }
        .sentence-part:active {
            cursor: grabbing;
            background-color: #9ca3af; /* gray-400 */
        }
        .drop-area {
            padding: 15px;
            margin-top: 10px;
            border: 2px dashed #9ca3af; /* gray-400 */
            border-radius: 8px;
            min-height: 50px;
            background-color: #f9fafb; /* gray-50 */
        }
        /* Prevent right-click context menu */
        body {
            /* Standard syntax */
            context-menu: none;
            /* Older browsers */
            oncontextmenu: "return false;";
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 antialiased">

    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-md rounded-b-lg">
        <div class="container mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-center">
            <div class="flex items-center space-x-4 mb-3 sm:mb-0">
                 <img src="https://media-hosting.imagekit.io//0b9a4af30efb4482/WhatsApp%20Image%202025-02-28%20at%203.15.19%20AM.jpeg?Expires=1835349432&Key-Pair-Id=K2ZIVPTIP2VGHC&Signature=jwJPYv24ynvpiPUADnh2kUGPUbG6OBggLpvXOj6~ZZAgts7lamWPTIZKmuIaQ5WaRUAG568acIjSbBE1XrKsIPvCHTXKNA-XF6ppaM~tacD0TMTVoTFd7-EsYFsesMaR~5AK7n5qr33hIwKVawluJ1rkdqmuQokM~T~W~O~6Yo-qXgYGio2IvfBsu1u~wEi1Cnk-5pAOavMUb9IfeY7E4FNwGBgiLCiHugKJD9sAY8As7S0szpehWI8WIQzMzNUFN4wvtPAamSART1m5nlUT4uLcvwdr-C1pk4kJN6I0itWzZEbZN04ANZexY3dpBhUDO0~UvQBCps64LPKIQBRYtA__"
                     alt="User Image" class="w-12 h-12 rounded-full border-2 border-white shadow-sm"
                     onerror="this.onerror=null; this.src='https://placehold.co/48x48/cccccc/ffffff?text=User';">
                 <span class="text-lg font-semibold">SYED ASGHAR ALI SHAH</span>
            </div>
            <h1 class="text-xl sm:text-2xl font-bold text-center">QUIZ FOR CSS ASPIRANTS 02 MAY 2025</h1>
            <div class="w-16 h-12 hidden sm:block"></div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">

        <section id="name-entry" class="bg-white p-6 rounded-lg shadow-md max-w-lg mx-auto text-center">
            <h2 class="text-2xl font-semibold mb-4 text-indigo-600">Welcome!</h2>
            <p class="mb-6 text-gray-600">Please enter your full name to start the quiz.</p>
            <input type="text" id="student-name" placeholder="Enter your full name" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4" required>
            <button id="start-quiz-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                Start Quiz
            </button>
            <p id="name-error" class="text-red-500 text-sm mt-2 hidden">Please enter your name.</p>
        </section>

        <section id="quiz-section" class="hidden bg-white p-6 rounded-lg shadow-md">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-200">
                 <h2 class="text-2xl font-semibold text-indigo-600">Quiz Questions</h2>
                 <div id="timer" class="text-xl font-bold text-red-600 bg-red-100 px-4 py-2 rounded-md shadow-sm">
                     Time Left: 40:00
                 </div>
            </div>

            <div id="question-container" class="mb-6">
                <h3 id="question-number" class="text-lg font-semibold mb-2 text-gray-700">Question 1 of 100</h3>
                <p id="question-text" class="text-lg mb-4"></p>
                <div id="options-container" class="space-y-3">
                    </div>
                 <div id="sentence-rearrangement-area" class="hidden mt-4">
                    <p class="text-sm text-gray-600 mb-2">Drag the parts below into the correct order in the box:</p>
                    <div id="sentence-parts-source" class="mb-3">
                        </div>
                    <div id="sentence-drop-area" class="drop-area border-2 border-dashed border-gray-400 rounded-md p-4 min-h-[60px] bg-gray-50">
                        </div>
                </div>
            </div>

            <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                 <button id="prev-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-md transition duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                     Previous
                 </button>
                 <div id="progress-indicator" class="text-sm text-gray-500"></div>
                 <button id="next-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-md transition duration-300 ease-in-out">
                     Next
                 </button>
                 <button id="submit-btn" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-md transition duration-300 ease-in-out">
                     Submit Quiz
                 </button>
            </div>
        </section>

        <section id="results-section" class="hidden bg-white p-6 rounded-lg shadow-md max-w-lg mx-auto text-center">
            <h2 class="text-2xl font-semibold mb-4 text-green-600">Quiz Results</h2>
            <div class="space-y-3 text-left border border-gray-200 p-4 rounded-md bg-gray-50">
                <p><strong>Name:</strong> <span id="result-name"></span></p>
                <p><strong>Questions Attempted:</strong> <span id="result-attempted"></span> / 100</p>
                <p><strong>Correct Answers:</strong> <span id="result-score"></span> / 100</p>
                <p><strong>Percentage:</strong> <span id="result-percentage"></span>%</p>
                <p><strong>Time Taken:</strong> <span id="result-time"></span></p>
            </div>
             <p class="mt-4 text-sm text-gray-500">Your results have been submitted.</p>
        </section>

        <form id="results-form" action="https://formspree.io/f/xwpvddea" method="POST" class="hidden">
            <input type="text" name="name" id="form-name">
            <input type="number" name="attempted" id="form-attempted">
            <input type="number" name="score" id="form-score">
            <input type="text" name="time_taken" id="form-time">
            <input type="text" name="percentage" id="form-percentage">
            <input type="hidden" name="_subject" value="CSS Aspirant Quiz Result">
        </form>

    </main>

    <footer class="bg-gray-800 text-white mt-12 py-6 rounded-t-lg shadow-inner">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">Need Assistance or Have Questions?</p>
            <p class="mb-3 font-semibold">Contact: 03265762698</p>
            <p class="text-sm text-gray-400">&copy; 2025 SYED ASGHAR ALI SHAH - All Rights Reserved.</p>
            <p class="text-sm text-gray-400 mt-1">Striving for Excellence in CSS Preparation</p>
        </div>
    </footer>

    <script>
        // --- Quiz Data ---
        // 100 Questions derived from provided PDFs (Grammar, Vocab, One Paper p75-100)
        const quizData = [
            // --- Grammar Questions (Approx. 25) ---
            {
                question: "In the sentence 'History offers sobering lessons regarding the economic toll', what part of speech is 'sobering'?",
                options: ["Verb", "Adverb", "Noun", "Adjective (Present Participle)"],
                answer: "Adjective (Present Participle)",
                type: "mcq"
            },
            {
                question: "Identify the mood of the verb 'must move' in 'The global community must move beyond passive concern...'",
                options: ["Indicative", "Imperative", "Subjunctive", "Conditional"],
                answer: "Subjunctive", // Expressing necessity/requirement
                type: "mcq"
            },
            {
                question: "Which of the following is a Noun Phrase from the text 'The Costs of Conflict'?",
                options: ["escalate between", "would lead to", "already struggling", "potential foreign investment outflows"],
                answer: "potential foreign investment outflows",
                type: "mcq"
            },
            {
                question: "The sentence 'Markets recovered, but the economic impact lingered...' is an example of which sentence type?",
                options: ["Simple", "Complex", "Compound", "Compound-Complex"],
                answer: "Compound",
                type: "mcq"
            },
            {
                question: "What is the grammatical function of the phrase 'by damaging infrastructure' in 'Conflict would worsen by damaging infrastructure...'?",
                options: ["Adjective phrase modifying 'Conflict'", "Adverbial phrase showing manner/means", "Noun phrase acting as subject", "Infinitive phrase showing purpose"],
                answer: "Adverbial phrase showing manner/means", // Prepositional phrase with gerund object
                type: "mcq"
            },
            {
                question: "Choose the sentence that uses a coordinating conjunction correctly to join two independent clauses:",
                options: [
                    "AS tensions escalate, danger lies beyond.",
                    "The conflict triggered a drop, Pakistan's GDP fell.",
                    "Food security would worsen, and progress towards SDGs would suffer.",
                    "If resources shift targets become unattainable."
                ],
                answer: "Food security would worsen, and progress towards SDGs would suffer.",
                type: "mcq"
            },
             {
                question: "Identify the abstract noun in the following options from the text:",
                options: ["neighbours", "ecosystems", "polarisation", "reserves"],
                answer: "polarisation",
                type: "mcq"
            },
             {
                question: "What tense is used in '...over 7m acres of forests and protected areas have been damaged since February 2022...'?",
                options: ["Past Simple Passive", "Present Perfect Passive", "Past Perfect Passive", "Present Continuous Passive"],
                answer: "Present Perfect Passive",
                type: "mcq"
            },
             {
                question: "The word 'fragile' in 'Pakistan’s more fragile economy' is a:",
                options: ["Noun", "Verb", "Adverb", "Comparative Adjective"],
                answer: "Comparative Adjective", // 'more fragile'
                type: "mcq"
            },
             {
                question: "Which word acts as a preposition in the phrase 'within days'?",
                options: ["days", "in", "with", "within"],
                answer: "within",
                type: "mcq"
            },
            {
                question: "Rearrange to form a grammatically correct sentence: ",
                parts: ["cannot adequately capture", "resulting from conflict", "human suffering", "Statistics"],
                answer: "Statistics cannot adequately capture human suffering resulting from conflict",
                type: "rearrangement"
            },
            {
                question: "What is the object of the preposition 'under' in '...facing intensified persecution under the nationalist fervour...'?",
                options: ["persecution", "intensified", "facing", "the nationalist fervour"],
                answer: "the nationalist fervour",
                type: "mcq"
            },
             {
                question: "Identify the linking verb in the sentence 'The choice is stark'.",
                options: ["choice", "stark", "The", "is"],
                answer: "is",
                type: "mcq"
            },
             {
                question: "Which sentence demonstrates correct subject-verb agreement?",
                options: [
                    "The devastation of economies are profound.",
                    "Each of the countries face risks.",
                    "Neither the US nor China possess all the answers.",
                    "Diplomatic channels that could prove crucial exist."
                ],
                answer: "Diplomatic channels that could prove crucial exist.", // 'channels...exist'
                type: "mcq"
            },
            {
                question: "The phrase 'to discourage adventurism' functions as what type of phrase modifying 'tools' in '...deploy all available diplomatic tools to discourage adventurism'?",
                options: ["Noun Phrase", "Adverbial Phrase", "Infinitive Phrase (Adjectival)", "Prepositional Phrase"],
                answer: "Infinitive Phrase (Adjectival)",
                type: "mcq"
            },
             {
                question: "What does the modal verb 'could' express in '...diplomatic channels that could prove crucial...'?",
                options: ["Obligation", "Past ability", "Certainty", "Possibility"],
                answer: "Possibility",
                type: "mcq"
            },
            {
                question: "Identify the gerund in the sentence: 'Enabling religious polarisation will find further targets.'",
                options: ["religious", "polarisation", "find", "Enabling"],
                answer: "Enabling",
                type: "mcq"
            },
             {
                question: "Which punctuation mark is used to introduce an explanation or list in the text, like in '...profound danger: the devastation...'?",
                options: ["Semicolon (;)", "Comma (,)", "Colon (:)", "Dash (—)"],
                answer: "Colon (:)",
                type: "mcq"
            },
            {
                question: "'Nuclear-armed' in 'nuclear-armed neighbours' is an example of a:",
                options: ["Prepositional phrase", "Compound noun", "Compound adjective", "Adverbial phrase"],
                answer: "Compound adjective",
                type: "mcq"
            },
             {
                question: "What is the function of 'permanently' in '...leave both nations permanently scarred'?",
                options: ["Adjective modifying nations", "Adverb modifying leave", "Adverb modifying scarred", "Noun phrase"],
                answer: "Adverb modifying scarred",
                type: "mcq"
            },
             {
                question: "Identify the relative pronoun in 'Civilian casualties... create wounds that economics cannot measure.'",
                options: ["casualties", "wounds", "economics", "that"],
                answer: "that",
                type: "mcq"
            },
            {
                question: "Which sentence contains a participial phrase used correctly?",
                options: [
                    "Struggling with reserves, the economy is fragile.", // Correct
                    "The economy struggling with reserves are fragile.", // Incorrect agreement
                    "Economy is fragile struggling with reserves.", // Awkward placement
                    "With reserves struggling the economy is fragile." // Incorrect structure
                ],
                answer: "Struggling with reserves, the economy is fragile.",
                type: "mcq"
            },
             {
                question: "The word 'Similarly' in 'The 2019 Pulwama crisis similarly witnessed...' functions as a:",
                options: ["Preposition", "Coordinating Conjunction", "Adjective", "Conjunctive Adverb"],
                answer: "Conjunctive Adverb",
                type: "mcq"
            },
             {
                question: "Choose the correct form: 'Its time / It's time for both countries...'",
                options: ["Its time", "It's time", "Its' time", "Itstime"],
                answer: "It's time", // Contraction for 'It is'
                type: "mcq"
            },
             {
                question: "What type of clause is 'if resources shift to conflict'?",
                options: ["Noun Clause", "Adjective Clause", "Independent Clause", "Adverbial Clause (Conditional)"],
                answer: "Adverbial Clause (Conditional)",
                type: "mcq"
            },

            // --- Vocabulary Questions (Idioms, Synonyms, Antonyms, Pairs - Approx. 25) ---
            {
                question: "The idiom 'Break the momentum' means:",
                options: ["To accelerate progress", "To stop the progress of something moving forward", "To reach a critical point", "To start a new phase"],
                answer: "To stop the progress of something moving forward",
                type: "mcq"
            },
            {
                question: "A synonym for 'Indignation' is:",
                options: ["Calmness", "Agreement", "Outrage", "Satisfaction"],
                answer: "Outrage",
                type: "mcq"
            },
            {
                question: "An antonym for 'Stem from' (meaning originate from) could be:",
                options: ["Result from", "Arise from", "Be unrelated to", "Cause"],
                answer: "Be unrelated to",
                type: "mcq"
            },
            {
                question: "The pair 'Public and private' relates to:",
                options: ["Openness and secrecy", "Government/state and individuals/companies", "Wealthy and poor", "Domestic and foreign"],
                answer: "Government/state and individuals/companies",
                type: "mcq"
            },
            {
                question: "'Ethically indefensible' means something is:",
                options: ["Morally justifiable", "Practically difficult", "Legally required", "Morally wrong and unjustifiable"],
                answer: "Morally wrong and unjustifiable",
                type: "mcq"
            },
            {
                question: "What does 'Scarcely afford' imply?",
                options: ["Easily manage", "Willingly pay for", "Barely able to manage due to lack of resources", "Invest heavily in"],
                answer: "Barely able to manage due to lack of resources",
                type: "mcq"
            },
            {
                question: "The idiom 'Zero-sum game' describes a situation where:",
                options: ["Everyone wins", "One side's gain is the other's loss", "No one gains or loses", "The outcome is uncertain"],
                answer: "One side's gain is the other's loss",
                type: "mcq"
            },
            {
                question: "A synonym for 'Ails us' (referring to problems) is:",
                options: ["Benefits us", "Strengthens us", "Plagues us", "Ignores us"],
                answer: "Plagues us",
                type: "mcq"
            },
             {
                question: "An antonym for 'Interlinked' is:",
                options: ["Connected", "Related", "Intertwined", "Disconnected"],
                answer: "Disconnected",
                type: "mcq"
            },
             {
                question: "The idiom 'Shot up' means:",
                options: ["Decreased slowly", "Remained stable", "Increased very quickly", "Exploded"],
                answer: "Increased very quickly",
                type: "mcq"
            },
             {
                question: "To 'Besmirch the country's fair name' means to:",
                options: ["Praise the country", "Damage the country's reputation", "Represent the country", "Defend the country"],
                answer: "Damage the country's reputation",
                type: "mcq"
            },
             {
                question: "'Next to impossible' means:",
                options: ["Very easy", "Slightly difficult", "Extremely difficult / Almost impossible", "Possible with effort"],
                answer: "Extremely difficult / Almost impossible",
                type: "mcq"
            },
             {
                question: "What does it mean to 'Use compassion as a compass'?",
                options: ["To navigate using stars", "To act ruthlessly", "To be guided by empathy and kindness", "To focus on self-interest"],
                answer: "To be guided by empathy and kindness",
                type: "mcq"
            },
             {
                question: "To be 'Struck by' something means to be:",
                options: ["Physically hit by it", "Indifferent to it", "Suddenly impressed or affected by it", "Annoyed by it"],
                answer: "Suddenly impressed or affected by it",
                type: "mcq"
            },
            {
                question: "Rearrange to form a meaningful idiom/phrase description:",
                parts: ["in a difficult situation", "to support someone or something", "rally together", "To come together"],
                answer: "To come together rally together to support someone or something in a difficult situation", // Might need adjustment based on desired format
                type: "rearrangement"
            },
             {
                question: "The idiom 'Lost their calm' means:",
                options: ["Became peaceful", "Fell asleep", "Became agitated or panicked", "Remained composed"],
                answer: "Became agitated or panicked",
                type: "mcq"
            },
             {
                question: "To 'Set aside differences' means to:",
                options: ["Emphasize conflicts", "Ignore disagreements for a common goal", "Create new problems", "Discuss differences openly"],
                answer: "Ignore disagreements for a common goal",
                type: "mcq"
            },
            {
                question: "A synonym for 'Put up a united front' is:",
                options: ["Show division", "Appear fragmented", "Show solidarity", "Argue publicly"],
                answer: "Show solidarity",
                type: "mcq"
            },
             {
                question: "An antonym for 'Keep their head' (remain calm) is:",
                options: ["Stay composed", "Keep cool", "Remain sensible", "Lose control / Panic"],
                answer: "Lose control / Panic",
                type: "mcq"
            },
             {
                question: "'Looming over their heads' suggests something:",
                options: ["Pleasant and expected", "Distant and unlikely", "Unwanted and likely to happen soon", "Completed and finished"],
                answer: "Unwanted and likely to happen soon",
                type: "mcq"
            },
             {
                question: "To 'Take for granted' means to:",
                options: ["Appreciate fully", "Value highly", "Cherish", "Fail to appreciate properly"],
                answer: "Fail to appreciate properly",
                type: "mcq"
            },
             {
                question: "What does 'Silence opposing viewpoints' mean?",
                options: ["Encourage debate", "Allow expression", "Listen carefully", "Prevent expression of different opinions"],
                answer: "Prevent expression of different opinions",
                type: "mcq"
            },
             {
                question: "To 'Rebuild bridges' means to:",
                options: ["Deepen divisions", "Construct new roads", "Restore friendly relations after conflict", "Burn connections"],
                answer: "Restore friendly relations after conflict",
                type: "mcq"
            },
             {
                question: "'Crystal clear' means:",
                options: ["Ambiguous", "Vague", "Difficult to see", "Perfectly easy to understand"],
                answer: "Perfectly easy to understand",
                type: "mcq"
            },
             {
                question: "The idiom 'Fall by the wayside' means:",
                options: ["To succeed against odds", "To persist", "To be maintained", "To fail or be neglected"],
                answer: "To fail or be neglected",
                type: "mcq"
            },

             // --- General Knowledge (One Paper MCQs p75-100) Questions (Approx. 50) ---
             // Personalities (p75-82)
            {
                question: "Who is known as the 'Iron Lady'?",
                options: ["Indira Gandhi", "Golda Meir", "Benazir Bhutto", "Margaret Thatcher"],
                answer: "Margaret Thatcher", // Verify from PDF p75-82
                type: "mcq"
            },
            {
                question: "Which famous leader was assassinated in 1948?",
                options: ["John F. Kennedy", "Abraham Lincoln", "Mahatma Gandhi", "Martin Luther King Jr."],
                answer: "Mahatma Gandhi", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "Mother Teresa was awarded the Nobel Peace Prize in which year?",
                options: ["1975", "1983", "1979", "1989"],
                answer: "1979", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "Who was the first Secretary-General of the United Nations?",
                options: ["Dag Hammarskjöld", "U Thant", "Kurt Waldheim", "Trygve Lie"],
                answer: "Trygve Lie", // Verify from PDF p75-82 or p93-96
                type: "mcq"
            },
             {
                question: "Yasser Arafat was the leader of which organization?",
                options: ["Hamas", "Hezbollah", "Palestine Liberation Organization (PLO)", "Muslim Brotherhood"],
                answer: "Palestine Liberation Organization (PLO)", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "Who is credited with the theory of relativity?",
                options: ["Isaac Newton", "Galileo Galilei", "Albert Einstein", "Stephen Hawking"],
                answer: "Albert Einstein", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "Which American president was involved in the Watergate scandal?",
                options: ["John F. Kennedy", "Lyndon B. Johnson", "Richard Nixon", "Gerald Ford"],
                answer: "Richard Nixon", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "'Che' Guevara was a major figure in the revolution of which country?",
                options: ["Argentina", "Bolivia", "Cuba", "Venezuela"],
                answer: "Cuba", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "Mikhail Gorbachev is known for his policies of 'Glasnost' and what else?",
                options: ["Kolkhoz", "Perestroika", "Apparatchik", "Sovkhoz"],
                answer: "Perestroika", // Verify from PDF p75-82
                type: "mcq"
            },
             {
                question: "Who was the first woman to travel into space?",
                options: ["Sally Ride", "Valentina Tereshkova", "Svetlana Savitskaya", "Judith Resnik"],
                answer: "Valentina Tereshkova", // Verify from PDF p75-82 or p97-100
                type: "mcq"
            },

            // Books & Literature (p83-87)
            {
                question: "Who wrote 'Das Kapital'?",
                options: ["Friedrich Engels", "Vladimir Lenin", "Adam Smith", "Karl Marx"],
                answer: "Karl Marx", // Verify from PDF p83-87
                type: "mcq"
            },
            {
                question: "'Animal Farm' is an allegorical novella by which author?",
                options: ["Aldous Huxley", "George Orwell", "J.R.R. Tolkien", "C.S. Lewis"],
                answer: "George Orwell", // Verify from PDF p83-87
                type: "mcq"
            },
             {
                question: "Who is the author of 'Pride and Prejudice'?",
                options: ["Charlotte Brontë", "Emily Brontë", "Mary Shelley", "Jane Austen"],
                answer: "Jane Austen", // Verify from PDF p83-87
                type: "mcq"
            },
             {
                question: "The play 'Hamlet' was written by:",
                options: ["Christopher Marlowe", "Ben Jonson", "William Shakespeare", "John Milton"],
                answer: "William Shakespeare", // Verify from PDF p83-87
                type: "mcq"
            },
             {
                question: "'The Adventures of Tom Sawyer' was written by:",
                options: ["Herman Melville", "Nathaniel Hawthorne", "Mark Twain", "Edgar Allan Poe"],
                answer: "Mark Twain", // Verify from PDF p83-87
                type: "mcq"
            },
             {
                question: "Who wrote 'One Hundred Years of Solitude'?",
                options: ["Mario Vargas Llosa", "Jorge Luis Borges", "Pablo Neruda", "Gabriel García Márquez"],
                answer: "Gabriel García Márquez", // Verify from PDF p83-87
                type: "mcq"
            },
            {
                question: "The book 'The Origin of Species' was authored by:",
                options: ["Gregor Mendel", "Louis Pasteur", "Charles Darwin", "Alfred Russel Wallace"],
                answer: "Charles Darwin", // Verify from PDF p83-87
                type: "mcq"
            },
             {
                question: "Who wrote the epic poem 'Paradise Lost'?",
                options: ["John Donne", "Geoffrey Chaucer", "John Milton", "Alexander Pope"],
                answer: "John Milton", // Verify from PDF p83-87
                type: "mcq"
            },
             {
                question: "'Gulliver's Travels' is a famous work by:",
                options: ["Daniel Defoe", "Jonathan Swift", "Samuel Richardson", "Henry Fielding"],
                answer: "Jonathan Swift", // Verify from PDF p83-87
                type: "mcq"
            },
            {
                question: "Who is the author of 'Mein Kampf'?",
                options: ["Benito Mussolini", "Joseph Stalin", "Adolf Hitler", "Winston Churchill"],
                answer: "Adolf Hitler", // Verify from PDF p83-87
                type: "mcq"
            },

            // Organizations of the World (p88-92)
            {
                question: "Where is the headquarters of the International Court of Justice located?",
                options: ["Geneva", "New York", "Brussels", "The Hague"],
                answer: "The Hague", // Verify from PDF p88-92 or p93-96
                type: "mcq"
            },
            {
                question: "NATO stands for:",
                options: [
                    "North African Treaty Organization",
                    "North Atlantic Treaty Organization",
                    "Neutral Asian Treaty Organization",
                    "Nordic Alliance and Treaty Organization"
                ],
                answer: "North Atlantic Treaty Organization", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "Which of these is NOT a member of the G7 group (as of early 2020s)?",
                options: ["Canada", "Russia", "Japan", "Italy"],
                answer: "Russia", // Verify from PDF p88-92 (Note: Membership can change)
                type: "mcq"
            },
             {
                question: "The headquarters of the World Bank is located in:",
                options: ["New York City", "Geneva", "London", "Washington D.C."],
                answer: "Washington D.C.", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "ASEAN primarily consists of countries from which region?",
                options: ["South Asia", "Africa", "Southeast Asia", "South America"],
                answer: "Southeast Asia", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "Interpol is an international organization focused on:",
                options: ["Economic cooperation", "Cultural exchange", "International police cooperation", "Environmental protection"],
                answer: "International police cooperation", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "The African Union (AU) succeeded which earlier organization?",
                options: [
                    "Organization of African Unity (OAU)",
                    "Economic Community of West African States (ECOWAS)",
                    "Southern African Development Community (SADC)",
                    "League of Arab States"
                    ],
                answer: "Organization of African Unity (OAU)", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "Where is the headquarters of the International Monetary Fund (IMF)?",
                options: ["Geneva", "Paris", "Washington D.C.", "Brussels"],
                answer: "Washington D.C.", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "SAARC stands for:",
                options: [
                    "South Asian Association for Regional Cooperation",
                    "Southeast Asian Alliance for Regional Cooperation",
                    "South African Association for Resource Control",
                    "Strategic Alliance for Asian Regional Commerce"
                    ],
                answer: "South Asian Association for Regional Cooperation", // Verify from PDF p88-92
                type: "mcq"
            },
             {
                question: "The main objective of the World Trade Organization (WTO) is to:",
                options: ["Provide loans to developing countries", "Regulate international trade", "Maintain international peace", "Promote cultural understanding"],
                answer: "Regulate international trade", // Verify from PDF p88-92
                type: "mcq"
            },

            // The United Nations (p93-96)
            {
                question: "Which organ of the UN is considered the main deliberative body?",
                options: ["Security Council", "General Assembly", "Secretariat", "Economic and Social Council (ECOSOC)"],
                answer: "General Assembly", // Verify from PDF p93-96
                type: "mcq"
            },
            {
                question: "How many non-permanent members does the UN Security Council have?",
                options: ["5", "15", "10", "7"],
                answer: "10", // Verify from PDF p93-96
                type: "mcq"
            },
             {
                question: "The 'Veto Power' in the UN Security Council is held by:",
                options: ["All 15 members", "Only the non-permanent members", "The Secretary-General", "The 5 permanent members"],
                answer: "The 5 permanent members", // Verify from PDF p93-96
                type: "mcq"
            },
             {
                question: "Which UN agency focuses on children's rights and well-being?",
                options: ["UNESCO", "WHO", "UNICEF", "UNHCR"],
                answer: "UNICEF", // Verify from PDF p93-96
                type: "mcq"
            },
             {
                question: "The headquarters of the United Nations is located in:",
                options: ["Geneva", "Paris", "The Hague", "New York City"],
                answer: "New York City", // Verify from PDF p93-96
                type: "mcq"
            },
             {
                question: "What is the primary role of the UN Secretariat?",
                options: ["Making binding decisions", "Commanding peacekeeping forces", "Carrying out the day-to-day work of the UN", "Judging international disputes"],
                answer: "Carrying out the day-to-day work of the UN", // Verify from PDF p93-96
                type: "mcq"
            },
             {
                question: "UNESCO is the UN agency primarily concerned with:",
                options: ["Health", "Refugees", "Food and Agriculture", "Education, Science and Culture"],
                answer: "Education, Science and Culture", // Verify from PDF p93-96
                type: "mcq"
            },
            {
                question: "Which country was NOT one of the original 5 permanent members of the UN Security Council?",
                options: ["France", "China (ROC initially)", "Germany", "United Kingdom"],
                answer: "Germany", // Verify from PDF p93-96
                type: "mcq"
            },
            {
                question: "The term of office for the UN Secretary-General is typically:",
                options: ["4 years", "5 years", "6 years", "7 years"],
                answer: "5 years", // Verify from PDF p93-96
                type: "mcq"
            },
             {
                question: "Which UN organ settles legal disputes between states?",
                options: ["General Assembly", "Security Council", "International Court of Justice (ICJ)", "Trusteeship Council"],
                answer: "International Court of Justice (ICJ)", // Verify from PDF p93-96
                type: "mcq"
            },

            // The World Records (p97-100)
            {
                question: "Which is the largest ocean in the world by area?",
                options: ["Atlantic Ocean", "Indian Ocean", "Arctic Ocean", "Pacific Ocean"],
                answer: "Pacific Ocean", // Verify from PDF p97-100
                type: "mcq"
            },
            {
                question: "The world's largest desert by area is:",
                options: ["Sahara Desert", "Arabian Desert", "Gobi Desert", "Antarctic Desert (Polar)"],
                answer: "Antarctic Desert (Polar)", // Note: Sahara is largest hot desert. Verify how PDF lists it. Assuming overall.
                type: "mcq"
            },
             {
                question: "Which country has the largest population in the world (as of data available in the PDF)?",
                options: ["India", "USA", "Indonesia", "China"],
                answer: "China", // Note: This can change, answer based on PDF's likely data timeframe.
                type: "mcq"
            },
             {
                question: "What is the highest waterfall in the world?",
                options: ["Niagara Falls", "Victoria Falls", "Angel Falls", "Iguazu Falls"],
                answer: "Angel Falls", // Verify from PDF p97-100
                type: "mcq"
            },
             {
                question: "Which is the longest river in Asia?",
                options: ["Mekong River", "Yellow River (Huang He)", "Ganges River", "Yangtze River"],
                answer: "Yangtze River", // Verify from PDF p97-100
                type: "mcq"
            },
             {
                question: "The world's largest island is:",
                options: ["Borneo", "Madagascar", "Greenland", "New Guinea"],
                answer: "Greenland", // Verify from PDF p97-100
                type: "mcq"
            },
             {
                question: "Which lake is the largest freshwater lake by surface area?",
                options: ["Lake Baikal", "Lake Superior", "Lake Victoria", "Great Bear Lake"],
                answer: "Lake Superior", // Verify from PDF p97-100 (Baikal is deepest/largest by volume)
                type: "mcq"
            },
             {
                question: "What is considered the world's most populous city (based on metropolitan area, verify PDF definition)?",
                options: ["Delhi", "Shanghai", "Sao Paulo", "Tokyo"],
                answer: "Tokyo", // Verify definition and data in PDF p97-100
                type: "mcq"
            },
             {
                question: "Which country is the largest by land area?",
                options: ["Canada", "China", "USA", "Russia"],
                answer: "Russia", // Verify from PDF p97-100
                type: "mcq"
            },
             {
                question: "The deepest point in the world's oceans is known as:",
                options: ["Puerto Rico Trench", "Java Trench", "Mariana Trench (Challenger Deep)", "Tonga Trench"],
                answer: "Mariana Trench (Challenger Deep)", // Verify from PDF p97-100
                type: "mcq"
            }
        ];

        // --- DOM Elements ---
        const nameEntrySection = document.getElementById('name-entry');
        const studentNameInput = document.getElementById('student-name');
        const nameError = document.getElementById('name-error');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const quizSection = document.getElementById('quiz-section');
        const resultsSection = document.getElementById('results-section');
        const questionContainer = document.getElementById('question-container');
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const sentenceRearrangementArea = document.getElementById('sentence-rearrangement-area');
        const sentencePartsSource = document.getElementById('sentence-parts-source');
        const sentenceDropArea = document.getElementById('sentence-drop-area');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const timerEl = document.getElementById('timer');
        const progressIndicator = document.getElementById('progress-indicator');

        // Results Elements
        const resultNameEl = document.getElementById('result-name');
        const resultAttemptedEl = document.getElementById('result-attempted');
        const resultScoreEl = document.getElementById('result-score');
        const resultPercentageEl = document.getElementById('result-percentage');
        const resultTimeEl = document.getElementById('result-time');

        // Formspree Form Elements
        const resultsForm = document.getElementById('results-form');
        const formName = document.getElementById('form-name');
        const formAttempted = document.getElementById('form-attempted');
        const formScore = document.getElementById('form-score');
        const formTime = document.getElementById('form-time');
        const formPercentage = document.getElementById('form-percentage');


        // --- Quiz State ---
        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizData.length).fill(null); // Store user answers
        let studentName = '';
        let timerInterval;
        let timeLeft = 40 * 60; // 40 minutes in seconds
        let startTime;
        let endTime;
        let quizSubmitted = false; // Flag to prevent multiple submissions

        // --- Drag and Drop State ---
        let draggedItem = null;

        // --- Utility Functions ---

        // Function to shuffle an array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            // Create a copy to avoid modifying the original array if it's passed directly
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]]; // Swap elements
            }
            return shuffled;
        }


        // --- Event Listeners ---
        startQuizBtn.addEventListener('click', startQuiz);
        nextBtn.addEventListener('click', nextQuestion);
        prevBtn.addEventListener('click', prevQuestion);
        submitBtn.addEventListener('click', () => submitQuiz(false)); // Pass false for manual submission

        // Add event listener for option selection (delegated)
        optionsContainer.addEventListener('change', handleOptionChange);
        optionsContainer.addEventListener('click', handleLabelClick); // For visual feedback

        // --- Core Quiz Logic ---

        function startQuiz() {
            studentName = studentNameInput.value.trim();
            if (!studentName) {
                nameError.classList.remove('hidden');
                return;
            }
            nameError.classList.add('hidden');
            nameEntrySection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            startTime = new Date(); // Record start time
             // Shuffle the entire quizData array once at the start
            // quizData = shuffleArray(quizData); // Optional: Shuffle question order
            loadQuestion(currentQuestionIndex);
            startTimer();
            updateProgressIndicator();
        }

        function loadQuestion(index) {
            // Ensure index is within bounds
             if (index < 0 || index >= quizData.length) {
                 console.error("Invalid question index:", index);
                 return;
             }
            const questionData = quizData[index];
            questionNumberEl.textContent = `Question ${index + 1} of ${quizData.length}`;
            questionTextEl.textContent = questionData.question;

            // Clear previous options/rearrangement area
            optionsContainer.innerHTML = '';
            sentenceRearrangementArea.classList.add('hidden');
            sentencePartsSource.innerHTML = '';
            sentenceDropArea.innerHTML = '';
            optionsContainer.classList.remove('hidden'); // Show MCQ area by default


            if (questionData.type === 'mcq') {
                 // Shuffle options before displaying
                const shuffledOptions = shuffleArray(questionData.options); // Pass the options array

                shuffledOptions.forEach((option, i) => {
                    const optionId = `q${index}_option${i}`;
                    const label = document.createElement('label');
                    label.htmlFor = optionId;
                    label.classList.add('option-label'); // Add class for styling

                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.id = optionId;
                    radio.name = `question${index}`;
                    radio.value = option; // Use the actual option value

                    // Check if this option was previously selected
                    if (userAnswers[index] === option) {
                        radio.checked = true;
                        label.classList.add('selected'); // Add selected class
                    }

                    const span = document.createElement('span');
                    span.textContent = option; // Display the option text

                    label.appendChild(radio);
                    label.appendChild(span);
                    optionsContainer.appendChild(label);
                });
            } else if (questionData.type === 'rearrangement') {
                optionsContainer.classList.add('hidden'); // Hide MCQ options area
                sentenceRearrangementArea.classList.remove('hidden');

                // Shuffle parts before displaying
                const shuffledParts = shuffleArray(questionData.parts); // Pass the parts array

                shuffledParts.forEach((part, i) => {
                    const partEl = document.createElement('div');
                    partEl.textContent = part;
                    partEl.classList.add('sentence-part');
                    partEl.draggable = true;
                    partEl.id = `part-${index}-${i}`; // Unique ID for the part
                    partEl.addEventListener('dragstart', handleDragStart);
                    sentencePartsSource.appendChild(partEl);
                });

                // Setup drop area listeners (add only once or manage removal)
                sentenceDropArea.removeEventListener('dragover', handleDragOver); // Remove previous if any
                sentenceDropArea.removeEventListener('drop', handleDrop); // Remove previous if any
                sentenceDropArea.addEventListener('dragover', handleDragOver);
                sentenceDropArea.addEventListener('drop', handleDrop);

                // Also allow dropping back into the source area
                sentencePartsSource.removeEventListener('dragover', handleDragOver);
                sentencePartsSource.removeEventListener('drop', handleDrop);
                sentencePartsSource.addEventListener('dragover', handleDragOver);
                sentencePartsSource.addEventListener('drop', handleDrop);


                // Load previously arranged answer if exists
                 if (userAnswers[index]) {
                     const savedParts = userAnswers[index].split(' | '); // Assuming parts are stored separated by ' | '
                     savedParts.forEach(partText => {
                         // Find the original draggable element from the source pool (if not already moved)
                         let originalPartEl = Array.from(sentencePartsSource.children).find(p => p.textContent === partText);

                         if (originalPartEl) {
                              sentenceDropArea.appendChild(originalPartEl); // Move the original element
                         } else {
                             // If it was already moved (e.g., navigating back/forth), recreate it in the drop area
                             // This part needs careful handling to avoid duplicates if navigating back and forth
                             // A simpler approach might be to just display the saved answer text, not make it draggable again when loading
                             const partEl = document.createElement('div');
                             partEl.textContent = partText;
                             partEl.classList.add('sentence-part');
                             partEl.draggable = false; // Make loaded parts non-draggable initially? Or handle IDs better.
                             partEl.id = `dropped-${Math.random()}`;
                             // partEl.addEventListener('dragstart', handleDragStart); // Re-enable drag?
                             sentenceDropArea.appendChild(partEl);
                         }
                     });
                 }
            }

            updateNavigationButtons();
        }

        function handleOptionChange(event) {
            if (event.target.type === 'radio') {
                // No need to manually set userAnswers here, saveCurrentAnswer handles it before navigation/submission
                 // Update visual selection
                document.querySelectorAll(`#options-container .option-label`).forEach(label => {
                    label.classList.remove('selected');
                });
                event.target.closest('label').classList.add('selected');
                // Auto-save on change (optional, but good for UX)
                 saveCurrentAnswer();
                 updateProgressIndicator();
            }
        }

         // Add visual feedback on label click itself
        function handleLabelClick(event) {
            const label = event.target.closest('label');
            if (label && label.classList.contains('option-label')) {
                const radio = label.querySelector('input[type="radio"]');
                if (radio && !radio.checked) {
                    radio.checked = true;
                    // Manually trigger change event to update answer state and visual
                    const changeEvent = new Event('change', { bubbles: true });
                    radio.dispatchEvent(changeEvent);
                }
            }
        }


        function nextQuestion() {
            saveCurrentAnswer(); // Save answer before moving
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            }
            // No need to update progress here, loadQuestion or change handler does it
        }

        function prevQuestion() {
            saveCurrentAnswer(); // Save answer before moving
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
             // No need to update progress here, loadQuestion or change handler does it
        }

        function saveCurrentAnswer() {
             // Ensure index is valid before accessing quizData
             if (currentQuestionIndex < 0 || currentQuestionIndex >= quizData.length) return;

             const questionData = quizData[currentQuestionIndex];
             if (questionData.type === 'mcq') {
                 const selectedOption = optionsContainer.querySelector(`input[name="question${currentQuestionIndex}"]:checked`);
                 userAnswers[currentQuestionIndex] = selectedOption ? selectedOption.value : null;
             } else if (questionData.type === 'rearrangement') {
                 const droppedParts = Array.from(sentenceDropArea.children).map(part => part.textContent.trim()); // Trim whitespace
                 userAnswers[currentQuestionIndex] = droppedParts.length > 0 ? droppedParts.join(' | ') : null; // Store as a delimited string
             }
        }


        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.classList.toggle('hidden', currentQuestionIndex === quizData.length - 1);
            submitBtn.classList.toggle('hidden', currentQuestionIndex !== quizData.length - 1);
        }

         function updateProgressIndicator() {
            // Count non-null answers
            const answeredCount = userAnswers.filter(answer => answer !== null && answer !== '').length;
            progressIndicator.textContent = `${answeredCount} / ${quizData.length} Answered`;
        }


        // --- Timer Logic ---
        function startTimer() {
             // Ensure timer doesn't restart if already running
            if (timerInterval) clearInterval(timerInterval);
            // Reset time left just in case
            // timeLeft = 40 * 60;
            updateTimerDisplay(); // Initial display
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            if (timeLeft > 0) {
                 timeLeft--;
                 updateTimerDisplay();
            }

            if (timeLeft <= 0) {
                submitQuiz(true); // Pass true to indicate auto-submission
            }
        }

         function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerEl.textContent = `Time Left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
         }

        function stopTimer() {
            clearInterval(timerInterval);
            timerInterval = null; // Clear the interval ID
        }

        // --- Results Logic ---
        function calculateResults() {
            let score = 0;
            let attempted = 0;
            userAnswers.forEach((answer, index) => {
                if (answer !== null && answer !== '') { // Check for non-empty answers too
                    attempted++;
                    const questionData = quizData[index];
                    let correctAnswer;
                    let isCorrect = false;

                     if (questionData.type === 'mcq') {
                         correctAnswer = questionData.answer;
                         isCorrect = (answer === correctAnswer);
                     } else if (questionData.type === 'rearrangement') {
                         // Compare the joined string, ignoring case and extra spaces for robustness
                         correctAnswer = questionData.answer.toLowerCase().replace(/\s+/g, ' ').trim();
                         const userAnswerString = answer ? answer.split(' | ').join(' ').toLowerCase().replace(/\s+/g, ' ').trim() : '';
                         isCorrect = (userAnswerString === correctAnswer);
                     }

                     if (isCorrect) {
                        score++;
                    }
                }
            });
            return { score, attempted };
        }

        function displayResults(score, attempted) {
            endTime = new Date();
            const timeDiff = Math.round((endTime - startTime) / 1000); // Time in seconds
            const minutesTaken = Math.floor(timeDiff / 60);
            const secondsTaken = timeDiff % 60;
            const timeTakenString = `${minutesTaken} min ${secondsTaken} sec`;
            // Calculate percentage based on total questions, not just attempted
            const percentage = quizData.length > 0 ? ((score / quizData.length) * 100).toFixed(1) : 0;


            resultNameEl.textContent = studentName;
            resultAttemptedEl.textContent = attempted;
            resultScoreEl.textContent = score;
            resultPercentageEl.textContent = percentage;
            resultTimeEl.textContent = timeTakenString;

            quizSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');

            // Populate and submit hidden form
            submitResultsToFormspree(studentName, attempted, score, timeTakenString, percentage);
        }

        function submitQuiz(isAutoSubmit = false) {
            if (quizSubmitted) return; // Prevent multiple submissions
            quizSubmitted = true;

            stopTimer();
            saveCurrentAnswer(); // Save the very last answer before calculating

            const { score, attempted } = calculateResults();
            displayResults(score, attempted);

            if (isAutoSubmit && resultsSection.children.length < 3) { // Avoid adding multiple messages
                // Optionally add a message indicating auto-submission
                const autoSubmitMsg = document.createElement('p');
                autoSubmitMsg.textContent = "Time ran out! Quiz submitted automatically.";
                autoSubmitMsg.classList.add('text-red-600', 'font-semibold', 'mt-4');
                // Insert after the H2 title
                resultsSection.insertBefore(autoSubmitMsg, resultsSection.children[1]);
            }
        }

        // --- Formspree Submission ---
        function submitResultsToFormspree(name, attempted, score, timeTaken, percentage) {
            formName.value = name;
            formAttempted.value = attempted;
            formScore.value = score;
            formTime.value = timeTaken;
            formPercentage.value = percentage + '%';


            // Use Fetch API to submit the form data asynchronously
            const formData = new FormData(resultsForm);
            fetch(resultsForm.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    console.log('Form submitted successfully to Formspree!');
                } else {
                     console.error('Formspree submission failed:', response.statusText);
                    response.json().then(data => {
                        if (Object.hasOwn(data, 'errors')) {
                             console.error("Formspree errors:", data["errors"].map(error => error["message"]).join(", "));
                        } else {
                            console.error('Non-OK response from Formspree, but no specific errors field. Body:', data);
                        }
                    }).catch(jsonError => {
                         console.error('Error parsing Formspree error response:', jsonError);
                    });
                }
            }).catch(error => {
                console.error('Network error submitting form to Formspree:', error);
            });
        }

         // --- Drag and Drop Handlers ---
        function handleDragStart(e) {
            // Check if the target is actually a draggable part
             if (e.target.classList.contains('sentence-part')) {
                draggedItem = e.target;
                // Use dataTransfer to store the ID of the dragged item
                e.dataTransfer.setData('text/plain', e.target.id);
                e.dataTransfer.effectAllowed = 'move';
                // Optional: Add styling for dragging element
                setTimeout(() => e.target.classList.add('opacity-50'), 0);
             } else {
                 e.preventDefault(); // Prevent dragging non-draggable elements
             }
        }

        function handleDragOver(e) {
            e.preventDefault(); // Necessary to allow dropping
            e.dataTransfer.dropEffect = 'move';
            // Optional: Add visual feedback for drop target
            const dropZone = e.target.closest('.drop-area, #sentence-parts-source');
             if(dropZone) {
                 dropZone.classList.add('bg-gray-200'); // Example highlight
             }
        }

         // Add dragleave listeners to remove highlight
        sentenceDropArea.addEventListener('dragleave', (e) => {
             const dropZone = e.target.closest('.drop-area');
             if (dropZone) {
                 dropZone.classList.remove('bg-gray-200');
             }
         });
         sentencePartsSource.addEventListener('dragleave', (e) => {
             const dropZone = e.target.closest('#sentence-parts-source');
             if (dropZone) {
                 dropZone.classList.remove('bg-gray-200');
             }
         });


        function handleDrop(e) {
            e.preventDefault();
             const dropZone = e.target.closest('.drop-area, #sentence-parts-source');
             const draggedId = e.dataTransfer.getData('text/plain');
             const draggedElement = document.getElementById(draggedId); // Get the element being dragged

             if (dropZone && draggedElement) {
                 // Append the actual dragged element
                 dropZone.appendChild(draggedElement);
                 // Restore appearance
                 draggedElement.classList.remove('opacity-50');
                 // Remove highlight
                 dropZone.classList.remove('bg-gray-200');

                 // Update the answer immediately after drop
                 saveCurrentAnswer();
                 updateProgressIndicator(); // Update answered count
             }
             // Reset highlight just in case it didn't clear on dragleave
             sentenceDropArea.classList.remove('bg-gray-200');
             sentencePartsSource.classList.remove('bg-gray-200');
        }


        // --- Anti-Inspect/Copy Measures ---

        // Disable right-click context menu
        document.addEventListener('contextmenu', event => event.preventDefault());

        // Disable common developer key combinations (basic deterrent)
        document.addEventListener('keydown', function(event) {
            // Disable F12
            if (event.key === "F12" || event.keyCode === 123) {
                event.preventDefault();
                return false;
            }
            // Disable Ctrl+Shift+I
            if (event.ctrlKey && event.shiftKey && (event.key === "I" || event.keyCode === 'I'.charCodeAt(0))) {
                 event.preventDefault();
                return false;
            }
             // Disable Ctrl+Shift+J
            if (event.ctrlKey && event.shiftKey && (event.key === "J" || event.keyCode === 'J'.charCodeAt(0))) {
                 event.preventDefault();
                return false;
            }
            // Disable Ctrl+Shift+C
            if (event.ctrlKey && event.shiftKey && (event.key === "C" || event.keyCode === 'C'.charCodeAt(0))) {
                 event.preventDefault();
                return false;
            }
            // Disable Ctrl+U
            if (event.ctrlKey && (event.key === "U" || event.keyCode === 'U'.charCodeAt(0))) {
                 event.preventDefault();
                return false;
            }
             // Disable Ctrl+S (Save page) - might interfere with normal saving if needed
             // if (event.ctrlKey && (event.key === "S" || event.keyCode === 'S'.charCodeAt(0))) {
             //     event.preventDefault();
             //     return false;
             // }
        });

        // Initial setup (optional, if needed)
         document.addEventListener('DOMContentLoaded', () => {
             // Initialize progress indicator on load
             updateProgressIndicator();
         });

    </script>

</body>
</html>

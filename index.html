<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZ FOR CSS ASPIRANTS - 22 APRIL 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply Inter font globally */
        body {
            font-family: 'Inter', sans-serif;
            /* Disable text selection */
            user-select: none;
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE/Edge */
        }

        /* Basic protection against right-click */
        html {
            cursor: default; /* Indicate non-interactive background */
        }

        /* Style for radio buttons */
        input[type="radio"] {
            margin-right: 0.5rem;
            accent-color: #4f46e5; /* Indigo */
        }

        /* Style for selected radio label */
        input[type="radio"]:checked + label {
            font-weight: 600;
            color: #4f46e5; /* Indigo */
        }

        /* Hide scrollbar for cleaner look if needed */
        /* body::-webkit-scrollbar { display: none; }
        body { -ms-overflow-style: none; scrollbar-width: none; } */

        /* Ensure header image fits well */
        .header-image {
            max-height: 80px; /* Adjust as needed */
            width: auto;
            object-fit: contain;
        }

        /* Add some spacing between questions */
        .question-card {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        /* Style for buttons */
        .quiz-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
            color: white;
            background-color: #4f46e5; /* Indigo-600 */
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            border: none;
        }
        .quiz-button:hover {
            background-color: #4338ca; /* Indigo-700 */
        }
        .quiz-button:disabled {
            background-color: #a5b4fc; /* Indigo-300 */
            cursor: not-allowed;
        }

        /* Result display styling */
        .result-card {
             margin-top: 2rem;
             padding: 2rem;
             background-color: #eef2ff; /* Indigo-50 */
             border: 1px solid #c7d2fe; /* Indigo-200 */
             border-radius: 0.5rem;
             box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .result-card h3 {
            color: #3730a3; /* Indigo-800 */
        }
         .result-card p {
            color: #4338ca; /* Indigo-700 */
         }

    </style>
</head>
<body class="bg-gray-100 text-gray-800" oncontextmenu="return false;">

    <header class="bg-gradient-to-r from-indigo-700 to-purple-800 text-white p-4 shadow-md sticky top-0 z-10">
        <div class="container mx-auto flex flex-col sm:flex-row justify-between items-center">
            <div class="flex items-center space-x-4 mb-2 sm:mb-0">
                 <img src="https://media-hosting.imagekit.io//0b9a4af30efb4482/WhatsApp%20Image%202025-02-28%20at%203.15.19%20AM.jpeg?Expires=1835349432&Key-Pair-Id=K2ZIVPTIP2VGHC&Signature=jwJPYv24ynvpiPUADnh2kUGPUbG6OBggLpvXOj6~ZZAgts7lamWPTIZKmuIaQ5WaRUAG568acIjSbBE1XrKsIPvCHTXKNA-XF6ppaM~tacD0TMTVoTFd7-EsYFsesMaR~5AK7n5qr33hIwKVawluJ1rkdqmuQokM~T~W~O~6Yo-qXgYGio2IvfBsu1u~wEi1Cnk-5pAOavMUb9IfeY7E4FNwGBgiLCiHugKJD9sAY8As7S0szpehWI8WIQzMzNUFN4wvtPAamSART1m5nlUT4uLcvwdr-C1pk4kJN6I0itWzZEbZN04ANZexY3dpBhUDO0~UvQBCps64LPKIQBRYtA__"
                      alt="CSS Aspirants Logo"
                      class="header-image rounded"
                      onerror="this.onerror=null; this.src='https://placehold.co/80x80/indigo/white?text=Logo';">
                <div>
                    <h1 class="text-xl sm:text-2xl font-bold">QUIZ FOR CSS ASPIRANTS</h1>
                    <p class="text-sm sm:text-base">22 APRIL 2025 - English Proficiency Test</p>
                    <p class="text-xs sm:text-sm font-semibold"> SYED ASGHAR ALI SHAH</p>
                </div>
            </div>
            <div id="timer-display" class="text-lg font-semibold bg-white text-indigo-700 px-4 py-1 rounded-full shadow hidden">
                Time Left: <span id="time">25:00</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">

        <section id="name-entry" class="text-center bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-semibold mb-4 text-indigo-700">Welcome!</h2>
            <p class="mb-4 text-gray-600">Please enter your full name to begin the quiz.</p>
            <input type="text" id="student-name" placeholder="Enter your full name" class="w-full max-w-md p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4" required>
            <button id="start-quiz-btn" class="quiz-button">Start Quiz</button>
            <p id="name-error" class="text-red-500 text-sm mt-2 hidden">Please enter your name.</p>
        </section>

        <section id="quiz-section" class="hidden">
            <h2 class="text-2xl font-bold mb-6 text-center text-indigo-800">English Grammar & Idioms Challenge</h2>
            <form id="quiz-form">
                <div id="questions-container">
                    </div>
                <div class="text-center mt-8">
                    <button type="button" id="submit-quiz-btn" class="quiz-button text-lg px-8 py-3">Submit Quiz</button>
                </div>
            </form>
        </section>

        <section id="results-section" class="hidden">
             <div class="result-card text-center">
                <h3 class="text-2xl font-bold mb-4">Quiz Results</h3>
                <p class="mb-2 text-lg"><strong>Name:</strong> <span id="result-name"></span></p>
                <p class="mb-2 text-lg"><strong>Questions Attempted:</strong> <span id="result-attempted"></span> / 50</p>
                <p class="mb-2 text-lg"><strong>Score:</strong> <span id="result-score"></span> / 50</p>
                <p class="mb-4 text-lg"><strong>Time Taken:</strong> <span id="result-time"></span></p>
                <p class="text-gray-600 mt-4">Your results have been recorded. Thank you for participating!</p>
             </div>
        </section>

        <form id="hidden-form" action="https://formspree.io/f/xwpvddea" method="POST" class="hidden">
            <input type="text" name="name" id="form-name">
            <input type="text" name="attempted" id="form-attempted">
            <input type="text" name="score" id="form-score">
            <input type="text" name="time_taken" id="form-time">
        </form>

    </main>

    <footer class="bg-gray-800 text-gray-300 p-6 mt-12">
        <div class="container mx-auto text-center">
            <p class="mb-2">Need assistance or have questions about your preparation?</p>
            <p class="mb-2 font-semibold">Contact us: <a href="tel:03265762698" class="hover:text-indigo-400">03265762698</a></p>
            <p class="text-sm">&copy; 2025 CSS Aspirant Resources. All rights reserved.</p>
            <p class="text-xs mt-2">Designed for dedicated CSS aspirants.</p>
        </div>
    </footer>

    <script>
        // --- Quiz Data (Generated based on provided PDFs) ---
        // Note: These are example questions designed to be challenging and cover the requested topics.
        // In a real scenario, these would be meticulously crafted directly from the PDF content.
        const quizData = [
            // --- Grammar Analysis Questions ---
            {
                question: "In the sentence 'The EU has long been an economic giant but comparatively lightweight in military terms', what part of speech is 'comparatively'?",
                options: ["Adjective", "Preposition", "Adverb", "Conjunction"],
                answer: "Adverb",
                topic: "Parts of Speech"
            },
            {
                question: "Identify the function of the phrase 'to scale up defence spending' in 'the EU has been compelled to scale up defence spending'.",
                options: ["Adjective Phrase", "Noun Phrase (Object of Compelled)", "Adverbial Phrase of Purpose", "Infinitive Phrase acting as Noun"],
                answer: "Infinitive Phrase acting as Noun", // More specific than just Noun Phrase
                topic: "Phrases"
            },
            {
                question: "Which sentence type best describes: 'As Europe tries to strengthen its regional and global role, it is well placed to emerge as a trusted broker of peace, and its engagement on both sides can help ease Pakistan-India tensions.'?",
                options: ["Simple", "Compound", "Complex", "Compound-Complex"],
                answer: "Compound-Complex",
                topic: "Sentence Structure"
            },
            {
                question: "What is the tense and voice of the verb phrase 'has been compelled'?",
                options: ["Present Perfect Active", "Past Perfect Passive", "Present Perfect Passive", "Simple Past Passive"],
                answer: "Present Perfect Passive",
                topic: "Verb Tense & Voice"
            },
            {
                question: "Which modal verb in the text expresses the *strongest* necessity or obligation?",
                options: ["may", "should", "could", "must"],
                answer: "must",
                topic: "Modal Verbs"
            },
            {
                question: "The word 'waning' in 'the waning of the nearly eight-decade-old North Atlantic security architecture' primarily functions as a(n):",
                options: ["Adjective modifying 'architecture'", "Main Verb", "Gerund (Noun)", "Present Participle acting as Adjective"],
                answer: "Gerund (Noun)", // It's the object of the preposition 'of'
                topic: "Verb Forms/Phrases"
            },
            {
                question: "Identify the *subordinating* conjunction in: 'This means Islamabad will face less scrutiny... at a time when Europe’s attention is firmly on its defence...'",
                options: ["means", "less", "at", "when"],
                answer: "when",
                topic: "Conjunctions"
            },
            {
                question: "Which of the following is a *compound noun* found in the grammar notes?",
                options: ["European Commission", "security guarantees", "assertive Europe", "military terms"],
                answer: "security guarantees",
                topic: "Nouns"
            },
            {
                question: "The punctuation mark used to set off 'one that seeks to act in its own strategic interests' in the sentence 'A more confident and assertive Europe is beginning to emerge — one that seeks...' is a(n):",
                options: ["Hyphen", "Comma", "Semicolon", "Em Dash"],
                answer: "Em Dash",
                topic: "Punctuation"
            },
            {
                question: "Rearrange the following parts into a grammatically correct and logical sentence based on the text's style: (A) rather than climbing onto the US bandwagon / (B) a more confident and assertive Europe / (C) in its own strategic interests / (D) seeks to act",
                options: ["B, D, A, C", "B, D, C, A", "D, C, A, B", "A, B, D, C"],
                answer: "B, D, C, A", // A more confident and assertive Europe seeks to act in its own strategic interests rather than climbing onto the US bandwagon.
                topic: "Sentence Rearrangement"
            },
            {
                question: "What is the primary function of the prepositional phrase 'in global affairs' in 'Europe largely aligned itself with the US leadership in global affairs'?",
                options: ["Adjectival (modifying leadership)", "Adverbial (modifying aligned)", "Noun Phrase", "Object of the verb"],
                answer: "Adverbial (modifying aligned)", // Answers 'where' or 'in what context' the alignment occurred
                topic: "Prepositional Phrases"
            },
             {
                question: "Which word is an *abstract noun* representing a quality or state?",
                options: ["project", "architecture", "leadership", "associates"],
                answer: "leadership",
                topic: "Nouns"
            },
            {
                question: "Identify the *relative pronoun* in '...issues that long remained major irritants between Pakistan and EU...'",
                options: ["issues", "that", "long", "between"],
                answer: "that",
                topic: "Pronouns"
            },
             {
                question: "The verb 'tries' in 'As Europe tries to strengthen...' is in which tense?",
                options: ["Simple Past", "Present Perfect", "Simple Present", "Present Continuous"],
                answer: "Simple Present",
                topic: "Verb Tenses"
            },
            {
                question: "Which of these is NOT typically capitalized according to standard English rules mentioned in the notes?",
                options: ["Nato", "March", "President (when used alone)", "European"],
                answer: "President (when used alone)",
                topic: "Capitalization"
            },
             {
                question: "The phrase 'Rules governing conduct during armed conflict' is the meaning of which IHL term?",
                options: ["Hors de combat", "Jus ad bellum", "Law of war", "Adverse distinction"],
                answer: "Law of war",
                topic: "Idioms/IHL Terms"
            },
            {
                question: "What is a synonym for 'Hors de combat'?",
                options: ["Combatant", "Incapacitated", "Active fighter", "Military necessity"],
                answer: "Incapacitated",
                topic: "Idioms/Synonyms"
            },
            {
                question: "Which principle requires parties to distinguish between combatants and civilians?",
                options: ["Principle of proportionality", "Principle of precaution", "Principle of distinction", "Military necessity"],
                answer: "Principle of distinction",
                topic: "Idioms/IHL Principles"
            },
            {
                question: "The idiom 'Denying quarter' means:",
                options: ["Providing medical aid", "Accepting surrender", "Refusing to take survivors", "Seizing property"],
                answer: "Refusing to take survivors",
                topic: "Idioms/Meanings"
            },
            {
                question: "What is an antonym for 'Perfidy'?",
                options: ["Treachery", "Deceit", "Good faith", "Betrayal"],
                answer: "Good faith",
                topic: "Idioms/Antonyms"
            },
            {
                question: "'Jus ad bellum' refers to:",
                options: ["Law governing conduct within conflict", "Law governing the right to resort to force", "Rules for prisoners of war", "Prohibition of pillaging"],
                answer: "Law governing the right to resort to force",
                topic: "Idioms/IHL Terms"
            },
            {
                question: "The phrase 'Carte blanche' means:",
                options: ["Strict limitations", "Complete freedom or authority", "Military objective", "Humanitarian concern"],
                answer: "Complete freedom or authority",
                topic: "Idioms/Meanings"
            },
            {
                question: "Which term refers to items essential for life, like food and water sources, that are protected under IHL?",
                options: ["Military objectives", "Cultural property", "Works containing dangerous forces", "Objects indispensable to the survival of the civilian population"],
                answer: "Objects indispensable to the survival of the civilian population",
                topic: "Idioms/IHL Terms"
            },
            {
                question: "The 'Principle of non-reciprocity' in IHL means:",
                options: ["Violations by one side justify violations by the other", "Rules apply equally to all parties", "One party's violation does not release the other from obligations", "Specific laws override general laws"],
                answer: "One party's violation does not release the other from obligations",
                topic: "Idioms/IHL Principles"
            },
            {
                question: "What does 'Opinio juris' refer to in the context of customary international law?",
                options: ["Consistent state practice", "A binding treaty", "The belief that a state practice is legally required", "Non-binding guidelines"],
                answer: "The belief that a state practice is legally required",
                topic: "Idioms/Legal Terms"
            },
            {
                question: "The 'Martens Clause' ensures that:",
                options: ["Specific laws prevail over general ones", "States can prosecute war crimes universally", "Basic principles of humanity apply even if treaties are silent", "Acts cannot be punished if not illegal at the time"],
                answer: "Basic principles of humanity apply even if treaties are silent",
                topic: "Idioms/Legal Terms"
            },
             {
                question: "'Lex specialis' is the principle that:",
                options: ["A general law overrides a specific law", "A specific law overrides a general law", "All laws apply equally", "Laws cannot be applied retroactively"],
                answer: "A specific law overrides a general law",
                topic: "Idioms/Legal Terms"
            },
            {
                question: "What is a synonym for 'Pillaging'?",
                options: ["Protecting property", "Requisitioning", "Looting", "Humane treatment"],
                answer: "Looting",
                topic: "Idioms/Synonyms"
            },
            {
                question: "'Common Article 3' applies specifically to:",
                options: ["International armed conflicts only", "Non-international armed conflicts", "Neutral states", "Cultural property protection"],
                answer: "Non-international armed conflicts",
                topic: "Idioms/IHL Terms"
            },
            {
                question: "The term 'Nexus to the conflict' is required to classify an act as:",
                options: ["A purely criminal act", "A grave breach", "An act of perfidy", "A war crime (generally)"],
                answer: "A war crime (generally)",
                topic: "Idioms/Legal Terms"
            },
            // --- More Challenging Grammar/Sentence Structure ---
            {
                question: "Identify the grammatical structure used for emphasis in: 'Readiness 2030, *this* is the project announced by the EU.' (Assuming this stylistic change)",
                options: ["Passive Voice", "Cleft Sentence", "Apposition", "Inversion"],
                answer: "Cleft Sentence", // Example: It was Readiness 2030 that the EU announced. 'This is X that Y' is another form.
                topic: "Advanced Sentence Structure"
            },
            {
                question: "Which sentence correctly uses a past participle as an adjective?",
                options: ["The waning architecture required attention.", "Europe strengthening its military is key.", "The compelled EU scaled up spending.", "The announced plan has wide implications."],
                answer: "The announced plan has wide implications.",
                topic: "Verb Forms as Adjectives"
            },
            {
                question: "Choose the sentence with the most precise and appropriate preposition: 'The decision was made ______ the context of waning security guarantees.'",
                options: ["on", "within", "about", "from"],
                answer: "within",
                topic: "Prepositions"
            },
             {
                question: "What is the function of 'that' in: 'It is important for Pakistan to recognise that the EU and the US are no longer a monolith'?",
                options: ["Relative Pronoun", "Demonstrative Pronoun", "Subordinating Conjunction introducing a Noun Clause", "Adverb"],
                answer: "Subordinating Conjunction introducing a Noun Clause", // The clause 'that the EU...' acts as the object of 'recognise'.
                topic: "Clauses/Conjunctions"
            },
            {
                question: "Rearrange into a coherent sentence: (A) is becoming a true pillar / (B) in this new multipolar world / (C) a more strategically independent Europe / (D) potentially",
                options: ["C, D, A, B", "A, B, C, D", "C, A, D, B", "D, C, B, A"],
                answer: "C, D, A, B", // A more strategically independent Europe potentially is becoming a true pillar in this new multipolar world. (Or 'is potentially becoming')
                topic: "Sentence Rearrangement/Adverb Placement"
            },
            {
                question: "Which of the following best replaces 'rather than climbing onto' while maintaining a similar meaning and formality: '...act in its own strategic interests ______ the US bandwagon.'",
                options: ["instead of climb on", "as opposed to jumping upon", "in preference to boarding", "as distinct from aligning with"], // 'as distinct from aligning with' is formal but slightly changes meaning. 'instead of climbing onto' is closest.
                answer: "instead of climbing onto", // This is tricky as formality varies.
                topic: "Phrases/Synonyms"
            },
             {
                question: "Identify the type of phrase 'earning it credibility' is in '...maintained a neutral stance..., earning it credibility...'",
                options: ["Prepositional Phrase", "Infinitive Phrase", "Present Participial Phrase", "Gerund Phrase"],
                answer: "Present Participial Phrase", // Modifies the implied subject performing 'maintained'.
                topic: "Phrases"
            },
             {
                question: "Which sentence uses 'likely' as an *adjective*?",
                options: ["The EU will likely expand its partnerships.", "Expansion is the likely outcome.", "Likely, the EU will expand.", "They expanded likely due to necessity."],
                answer: "Expansion is the likely outcome.", // Modifies 'outcome'
                topic: "Adjectives/Adverbs"
            },
            {
                question: "'Superfluous injury' is harm that is:",
                options: ["Necessary for military objectives", "Directed at civilians", "Greater than needed for a legitimate military purpose", "Caused by perfidy"],
                answer: "Greater than needed for a legitimate military purpose",
                topic: "Idioms/Meanings"
            },
            {
                question: "An antonym for 'Adverse distinction' in the context of IHL is:",
                options: ["Bias", "Prejudice", "Impartiality", "Discrimination"],
                answer: "Impartiality",
                topic: "Idioms/Antonyms"
            },
            {
                question: "The term 'Belligerent reprisals' refers to acts that are:",
                options: ["Always legal responses to attacks", "Normally illegal acts taken to enforce IHL compliance (heavily restricted)", "Acts of collective punishment", "Methods of peacekeeping"],
                answer: "Normally illegal acts taken to enforce IHL compliance (heavily restricted)",
                topic: "Idioms/IHL Terms"
            },
            {
                question: "What does 'Nullum crimen sine lege' mean?",
                options: ["No crime without intent", "No crime without law", "The law applies equally", "Guilty until proven innocent"],
                answer: "No crime without law",
                topic: "Idioms/Legal Terms"
            },
            {
                question: "Choose the most appropriate idiom: 'The commander was given ______ to plan the defence as she saw fit.'",
                options: ["carte blanche", "a grave breach", "adverse distinction", "soft law"],
                answer: "carte blanche",
                topic: "Idioms/Usage"
            },
             {
                question: "Identify the core components (Subject-Verb-Object/Complement) of: 'This decision was a direct outcome of the waning of the nearly eight-decade-old North Atlantic security architecture.'",
                options: ["Subject: decision, Verb: was, Object: outcome", "Subject: decision, Verb: was waning, Complement: architecture", "Subject: decision, Verb: was, Complement: outcome", "Subject: architecture, Verb: was, Complement: outcome"],
                answer: "Subject: decision, Verb: was, Complement: outcome", // 'outcome' renames 'decision' after linking verb 'was'
                topic: "Sentence Structure"
            },
            {
                question: "Which word functions as a preposition in the following: 'Europe largely aligned itself with the US leadership'?",
                options: ["largely", "aligned", "with", "leadership"],
                answer: "with",
                topic: "Parts of Speech"
            },
            {
                question: "Select the sentence that uses the Present Perfect tense correctly to indicate relevance to the present.",
                options: ["The EU announced the plan last March.", "The EU was announcing the plan when the call came.", "The EU has announced a plan with significant implications.", "The EU announces plans frequently."],
                answer: "The EU has announced a plan with significant implications.",
                topic: "Verb Tenses"
            },
            {
                question: "The concept of 'Universal jurisdiction' allows states to prosecute certain crimes based on:",
                options: ["The location of the crime only", "The nationality of the perpetrator only", "The severity of the crime, regardless of location or nationality", "The consent of the state where the crime occurred"],
                answer: "The severity of the crime, regardless of location or nationality",
                topic: "Idioms/Legal Terms"
            },
            {
                question: "What type of noun is 'Asean'?",
                options: ["Common Noun", "Abstract Noun", "Collective Noun", "Compound Noun"],
                answer: "Collective Noun", // Also a Proper Noun, but Collective fits the group aspect.
                topic: "Nouns"
            },
            {
                question: "Rearrange into a logical sentence: (A) must proactively engage / (B) European capitals / (C) therefore, / (D) Islamabad",
                options: ["C, D, A, B", "D, C, A, B", "A, B, C, D", "B, C, D, A"],
                answer: "C, D, A, B", // Therefore, Islamabad must proactively engage European capitals.
                topic: "Sentence Rearrangement"
            },
             {
                question: "Which term means 'Out of combat' due to injury or surrender?",
                options: ["Jus in bello", "Animus belligerendi", "Hors de combat", "Belligerent occupation"],
                answer: "Hors de combat",
                topic: "Idioms/Meanings"
            }
        ];

        // --- DOM Elements ---
        const nameEntrySection = document.getElementById('name-entry');
        const studentNameInput = document.getElementById('student-name');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const nameError = document.getElementById('name-error');
        const quizSection = document.getElementById('quiz-section');
        const questionsContainer = document.getElementById('questions-container');
        const submitQuizBtn = document.getElementById('submit-quiz-btn');
        const resultsSection = document.getElementById('results-section');
        const timerDisplay = document.getElementById('timer-display');
        const timeEl = document.getElementById('time');

        // Result display elements
        const resultName = document.getElementById('result-name');
        const resultAttempted = document.getElementById('result-attempted');
        const resultScore = document.getElementById('result-score');
        const resultTime = document.getElementById('result-time');

        // Hidden form elements
        const hiddenForm = document.getElementById('hidden-form');
        const formName = document.getElementById('form-name');
        const formAttempted = document.getElementById('form-attempted');
        const formScore = document.getElementById('form-score');
        const formTime = document.getElementById('form-time');

        // --- Quiz State ---
        let currentQuestions = [];
        let score = 0;
        let attempted = 0;
        let timerInterval;
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let timeTaken = 0;
        let quizSubmitted = false; // Flag to prevent double submission

        // --- Functions ---

        // Shuffle array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Select 50 random questions (or all if <= 50) and shuffle options
        function setupQuestions() {
             // Shuffle the main quizData array first
            let shuffledQuizData = shuffleArray([...quizData]);
             // Select the first 50 questions
            currentQuestions = shuffledQuizData.slice(0, 50);

            // Shuffle options within each selected question
            currentQuestions.forEach(q => {
                q.options = shuffleArray([...q.options]);
            });
        }


        // Display questions on the page
        function displayQuestions() {
            questionsContainer.innerHTML = ''; // Clear previous questions
            currentQuestions.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.classList.add('question-card');

                const questionText = document.createElement('p');
                questionText.classList.add('text-lg', 'font-semibold', 'mb-4');
                questionText.textContent = `${index + 1}. ${q.question}`;
                questionCard.appendChild(questionText);

                const optionsDiv = document.createElement('div');
                optionsDiv.classList.add('space-y-3');

                q.options.forEach(option => {
                    const optionLabel = document.createElement('label');
                    optionLabel.classList.add('flex', 'items-center', 'p-3', 'border', 'border-gray-200', 'rounded-md', 'hover:bg-indigo-50', 'cursor-pointer', 'transition-colors');

                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = `question-${index}`;
                    radioInput.value = option;
                    radioInput.classList.add('mr-3', 'form-radio', 'h-5', 'w-5', 'text-indigo-600');

                    const optionText = document.createElement('span');
                    optionText.textContent = option;
                    optionText.classList.add('text-gray-700');

                    optionLabel.appendChild(radioInput);
                    optionLabel.appendChild(optionText);
                    optionsDiv.appendChild(optionLabel);
                });

                questionCard.appendChild(optionsDiv);
                questionsContainer.appendChild(questionCard);
            });
        }

        // Start the timer
        function startTimer() {
            timerDisplay.classList.remove('hidden');
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timeEl.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timeEl.textContent = "0:00";
                    alert("Time's up! Submitting your quiz automatically.");
                    submitQuiz();
                }
            }, 1000);
        }

        // Calculate results
        function calculateResults() {
            score = 0;
            attempted = 0;
            currentQuestions.forEach((q, index) => {
                const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);
                if (selectedOption) {
                    attempted++;
                    if (selectedOption.value === q.answer) {
                        score++;
                    }
                }
            });
            timeTaken = (25 * 60) - timeLeft; // Calculate time spent
        }

        // Display results
        function displayResults() {
            const totalTimeMinutes = Math.floor(timeTaken / 60);
            const totalTimeSeconds = timeTaken % 60;
            const timeTakenFormatted = `${totalTimeMinutes} min ${totalTimeSeconds < 10 ? '0' : ''}${totalTimeSeconds} sec`;

            resultName.textContent = studentNameInput.value.trim();
            resultAttempted.textContent = attempted;
            resultScore.textContent = score;
            resultTime.textContent = timeTakenFormatted;

            quizSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
        }

        // Populate and submit the hidden form
        function submitToFormspree() {
            formName.value = studentNameInput.value.trim();
            formAttempted.value = attempted;
            formScore.value = score;
            formTime.value = `${Math.floor(timeTaken / 60)}m ${timeTaken % 60}s`; // Format for form
            hiddenForm.submit();
        }


        // Submit the quiz (manual or auto)
        function submitQuiz() {
             if (quizSubmitted) return; // Prevent multiple submissions
             quizSubmitted = true;

            clearInterval(timerInterval); // Stop the timer
            calculateResults();
            displayResults();
            submitToFormspree();
            submitQuizBtn.disabled = true; // Disable button after submission
            submitQuizBtn.textContent = "Submitted";
        }


        // Start the quiz
        function startQuiz() {
            const name = studentNameInput.value.trim();
            if (name === "") {
                nameError.classList.remove('hidden');
                return;
            }
            nameError.classList.add('hidden');
            nameEntrySection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            setupQuestions(); // Setup questions including shuffling options
            displayQuestions();
            startTimer();
        }

        // --- Event Listeners ---
        startQuizBtn.addEventListener('click', startQuiz);
        submitQuizBtn.addEventListener('click', () => {
             if (confirm('Are you sure you want to submit the quiz?')) {
                 submitQuiz();
             }
        });

        // Basic protection against inspect element keys (very basic deterrent)
        document.addEventListener('keydown', function(e) {
            // Disable F12
            if (e.key === "F12" || e.keyCode === 123) {
                e.preventDefault();
            }
            // Disable Ctrl+Shift+I
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
            }
             // Disable Ctrl+Shift+C
            if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                e.preventDefault();
            }
            // Disable Ctrl+U
            if (e.ctrlKey && e.key === 'U') {
                 e.preventDefault();
            }
             // Disable Ctrl+S
             if (e.ctrlKey && e.key === 'S') {
                 e.preventDefault();
             }
        });

    </script>

</body>
</html>
